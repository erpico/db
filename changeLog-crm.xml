<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<databaseChangeLog xmlns="http://www.liquibase.org/xml/ns/dbchangelog"
                   xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
                   xsi:schemaLocation="http://www.liquibase.org/xml/ns/dbchangelog http://www.liquibase.org/xml/ns/dbchangelog/dbchangelog-2.0.xsd"
                   logicalFilePath="erpico_crm">
  <changeSet id="2013-09-23-01" author="kae">
    <sql><![CDATA[
      CREATE TABLE IF NOT EXISTS `order_type` (
        `id` int(10) unsigned NOT NULL AUTO_INCREMENT,
        `name` varchar(256) NOT NULL,
        `short_name` varchar(64) DEFAULT NULL,
        `description` varchar(1024) DEFAULT NULL,
        `icon` tinyint(4) DEFAULT NULL,
        `small_icon` tinyint(4) DEFAULT NULL,
        `state_model_kind` varchar(32) NOT NULL,
        `handle` varchar(32) NOT NULL,
        `order_number` tinyint(4) NOT NULL DEFAULT '0',
        PRIMARY KEY (`id`)
      );
    ]]></sql>
  </changeSet>
  <changeSet id="2014-07-17-01" author="kae">
    <sql><![CDATA[
      ALTER TABLE `sms_pool` CHANGE COLUMN `message_id` `message_id` VARCHAR(127) NOT NULL DEFAULT '0';
    ]]></sql>
  </changeSet>
  <changeSet id="2014-07-17-02" author="kae">
    <sql><![CDATA[
      ALTER TABLE `sms_in` CHANGE COLUMN `message_id` `message_id` VARCHAR(127) NOT NULL DEFAULT '0'  ;
    ]]></sql>
  </changeSet>
  <changeSet id="2014-07-17-03" author="kae">
    <sql><![CDATA[
      CREATE TABLE `order_call_history` (
        `id` int(11) NOT NULL AUTO_INCREMENT,
        `order_id` int(11) NOT NULL,
        `call_id` bigint(20) NOT NULL,
        `created` datetime NOT NULL,
        PRIMARY KEY (`id`)
      );
    ]]></sql>
  </changeSet>
  <changeSet id="2014-07-17-04" author="kae">
    <sql><![CDATA[
      INSERT INTO `cfg_setting` (`handle`, `val`) VALUES ('crm.map.enabled', '0');
    ]]></sql>
  </changeSet>
  <changeSet id="2014-07-17-05" author="mrk">
    <sql><![CDATA[
      CREATE TABLE `taxi_city_services` (
        `city_id` int(10) NOT NULL,
        `service_id` int(10) NOT NULL,
        PRIMARY KEY (`city_id`,`service_id`)
      );
    ]]></sql>
  </changeSet>
  <changeSet id="2014-07-17-06" author="mrk">
    <sql>
      <![CDATA[
      ALTER TABLE `taxi_prices` 
        ADD COLUMN `city_id` INT(10) NOT NULL AFTER `service_id`,
        DROP PRIMARY KEY,
        ADD PRIMARY KEY (`service_id`, `city_id`, `class_id`);
    ]]></sql>
  </changeSet>
  <changeSet id="2014-07-17-07" author="mrk">
    <sql>
      <![CDATA[
      SELECT @val := val+0 FROM `cfg_setting` where `handle` = 'crm.city.id';

      UPDATE `taxi_prices` SET `city_id` = SUBSTRING_INDEX(@val, ';', 1);

      insert into `taxi_city_services` (`city_id`, `service_id`) select SUBSTRING_INDEX(@val, ';', 1), `id` from `taxi_service` where `id` > 6;
    ]]>
    </sql>
  </changeSet>
  <changeSet id="2014-09-02-01" author="kae">
    <sql><![CDATA[
      CREATE  TABLE IF NOT EXISTS `billing_account_type` (
        `id` INT NOT NULL AUTO_INCREMENT,
        `name` VARCHAR(255) NOT NULL,
        PRIMARY KEY (`id`))
      ENGINE = InnoDB;
    ]]></sql>
  </changeSet>
  <changeSet id="2014-09-02-02" author="kae">
    <sql><![CDATA[
      CREATE  TABLE IF NOT EXISTS `billing_account` (
        `id` INT NOT NULL AUTO_INCREMENT ,
        `kind` TINYINT(1) NOT NULL ,
        `owner_id` INT NOT NULL ,
        `type_id` INT NOT NULL ,
        `primary` TINYINT(1) NOT NULL DEFAULT 0 ,
        `balance` DECIMAL(10,2) NOT NULL DEFAULT 0.0 ,
        PRIMARY KEY (`id`) ,
        INDEX `fk_billing_account_type_idx` (`type_id` ASC) ,
        CONSTRAINT `fk_billing_account_type`
          FOREIGN KEY (`type_id` )
          REFERENCES `billing_account_type` (`id` )
          ON DELETE RESTRICT
          ON UPDATE RESTRICT)
      ENGINE = InnoDB;
    ]]></sql>
  </changeSet>
  <changeSet id="2014-09-02-03" author="kae">
    <sql><![CDATA[
      CREATE  TABLE IF NOT EXISTS `client_billing_rule` (
        `id` INT NOT NULL AUTO_INCREMENT,
        `action` TINYINT(2) NOT NULL,
        `billing_account_type_id` INT NOT NULL,
        PRIMARY KEY (`id`),
        INDEX `fk_client_billing_rule_billing_account_type1_idx` (`billing_account_type_id` ASC),
        CONSTRAINT `fk_client_billing_rule_billing_account_type1`
          FOREIGN KEY (`billing_account_type_id` )
          REFERENCES `billing_account_type` (`id` )
          ON DELETE RESTRICT
          ON UPDATE RESTRICT)
      ENGINE = InnoDB;
    ]]></sql>
  </changeSet>
  <changeSet id="2014-09-02-04" author="kae">
    <sql><![CDATA[
      INSERT INTO `billing_account_type` (`id`, `name`) VALUES (1, 'Основной счет');
      INSERT INTO `billing_account_type` (`id`, `name`) VALUES (2, 'Бонусный счет');

      /*
        bm_Unknown = 0,
        bm_User   = 1,
        bm_Service = 2,
        bm_Megadiscount = 3,
        bm_Bonus = 4,
        bm_BonusFromFriend = 5,
        bm_RegisterWithFriend = 6,
        bm_WWW_Service = 7,
        bm_DeliveryFromOrder = 8,
        bm_VipPlatinumCard = 9,
        bm_Checkpoint = 10,
        bm_ServiceCredit = 11
       */
      INSERT INTO `client_billing_rule` (`action`, `billing_account_type_id`) VALUES ('0', '1');
      INSERT INTO `client_billing_rule` (`action`, `billing_account_type_id`) VALUES ('1', '1');
      INSERT INTO `client_billing_rule` (`action`, `billing_account_type_id`) VALUES ('2', '1');
      INSERT INTO `client_billing_rule` (`action`, `billing_account_type_id`) VALUES ('3', '1');
      INSERT INTO `client_billing_rule` (`action`, `billing_account_type_id`) VALUES ('4', '2');
      INSERT INTO `client_billing_rule` (`action`, `billing_account_type_id`) VALUES ('5', '2');
      INSERT INTO `client_billing_rule` (`action`, `billing_account_type_id`) VALUES ('6', '2');
      INSERT INTO `client_billing_rule` (`action`, `billing_account_type_id`) VALUES ('7', '1');
      INSERT INTO `client_billing_rule` (`action`, `billing_account_type_id`) VALUES ('8', '1');
      INSERT INTO `client_billing_rule` (`action`, `billing_account_type_id`) VALUES ('9', '1');
      INSERT INTO `client_billing_rule` (`action`, `billing_account_type_id`) VALUES ('10', '1');
      INSERT INTO `client_billing_rule` (`action`, `billing_account_type_id`) VALUES ('11', '1');
    ]]></sql>
  </changeSet>
  <changeSet id="2014-09-02-05" author="kae">
    <sql>
      <![CDATA[
      ALTER TABLE `clients_billing`
        ADD COLUMN `account_id` INT NULL AFTER `client_id`;
    ]]></sql>
  </changeSet>
  <changeSet id="2014-09-02-06" author="kae">
    <createProcedure><![CDATA[
      CREATE PROCEDURE `create_clients_billing_accounts`() BEGIN
        DECLARE done INT DEFAULT 0;
        DECLARE client_id DECIMAL(10, 2);
        DECLARE balance DECIMAL(10, 2);
        DECLARE cur CURSOR FOR SELECT c.id, c.balans FROM clients c ORDER BY c.id;
        DECLARE CONTINUE HANDLER FOR NOT FOUND SET done = 1;

        PREPARE update_clients_billing_stmt FROM 'UPDATE clients_billing SET `account_id`=? WHERE `client_id`=?';

        SET @account_id=0;
        SET @client_id=0;

        OPEN cur;
        read_loop: LOOP
          FETCH cur INTO client_id, balance;
          IF done THEN
            LEAVE read_loop;
          END IF;

          SET @client_id=client_id;

          SET @account_id = @account_id + 1;
          INSERT INTO `billing_account` (`id`, `kind`, `owner_id`, `type_id`, `primary`, `balance`)
            VALUES (@account_id, '0', @client_id, '1', '1', balance);

          EXECUTE update_clients_billing_stmt USING @account_id, @client_id;

          SET @account_id = @account_id + 1;
          INSERT INTO `billing_account` (`id`, `kind`, `owner_id`, `type_id`, `primary`, `balance`)
            VALUES (@account_id, '0', @client_id, '2', '0', '0.0');

          COMMIT;
        END LOOP;

        DEALLOCATE PREPARE update_clients_billing_stmt;

        SET @account_id = @account_id + 1;
        SET @SQL := CONCAT('ALTER TABLE billing_account AUTO_INCREMENT =  ', @account_id);
        PREPARE _stmt FROM @SQL;
        EXECUTE _stmt;
        DEALLOCATE PREPARE _stmt;

        CLOSE cur;
      END;
    ]]></createProcedure>
  </changeSet>
  <changeSet id="2014-09-02-07" author="kae">
    <sql><![CDATA[
      call `create_clients_billing_accounts`();
    ]]></sql>
  </changeSet>
  <changeSet id="2014-09-02-08" author="kae">
    <sql><![CDATA[
       DROP PROCEDURE `create_clients_billing_accounts`;
    ]]></sql>
  </changeSet>
  <changeSet id="2014-09-02-09" author="kae">
    <sql><![CDATA[
      ALTER TABLE `clients_billing`
        CHANGE COLUMN `account_id` `account_id` INT(11) NOT NULL,
        ADD INDEX `account_id` (`account_id` ASC) ;
    ]]></sql>
  </changeSet>
  <changeSet id="2014-09-02-10" author="kae">
    <sql><![CDATA[
      ALTER TABLE `billing_account`
        ADD UNIQUE INDEX `uk_billing_account_kind_owner_type` (`kind` ASC, `owner_id` ASC, `type_id` ASC) ;
    ]]></sql>
  </changeSet>
  <changeSet id="2014-09-02-11" author="kae">
    <sql><![CDATA[
      ALTER TABLE `billing_account`
        ADD INDEX `idx_billing_account_kind_owner` (`kind` ASC, `owner_id` ASC) ;
    ]]></sql>
  </changeSet>
  <changeSet id="2014-09-02-12" author="kae">
    <sql><![CDATA[
      ALTER TABLE `client_billing_rule`
        ADD UNIQUE INDEX `uk_client_billing_rule_action` (`action` ASC) ;
    ]]></sql>
  </changeSet>
  <changeSet id="2014-09-02-13" author="kae">
    <sql><![CDATA[
      ALTER TABLE `clients` DROP COLUMN `balans`;
    ]]></sql>
  </changeSet>
  <changeSet id="2014-09-09-01" author="kae">
    <sql><![CDATA[
      CREATE  TABLE `executor_alarm` (
        `id` INT NOT NULL AUTO_INCREMENT ,
        `executor_id` INT NOT NULL ,
        `created` DATETIME NOT NULL ,
        `active` TINYINT NOT NULL ,
        PRIMARY KEY (`id`) );
    ]]></sql>
  </changeSet>
  <changeSet id="2014-09-09-02" author="kae">
    <sql><![CDATA[
      ALTER TABLE `zakazi`
        ADD COLUMN `account_id` INT(10) NULL DEFAULT '0' AFTER `sum_from_schet`;
    ]]></sql>
  </changeSet>
  <changeSet id="2014-10-08-01" author="kae">
    <sql><![CDATA[
      ALTER TABLE `zakazi_archive`
        ADD COLUMN `account_id` INT(10) NULL DEFAULT '0' AFTER `sum_from_schet`;
    ]]></sql>
  </changeSet>
  <changeSet id="2014-10-15-01" author="kae">
    <sql><![CDATA[
      ALTER TABLE `services_citys` ADD COLUMN `service_name` VARCHAR(255) NULL  AFTER `name` ;
    ]]></sql>
  </changeSet>
  <changeSet id="2014-10-15-02" author="kae">
    <sql><![CDATA[
      UPDATE `services_citys` set `service_name`=`name` ;
    ]]></sql>
  </changeSet>
  <changeSet id="2014-10-15-03" author="kae">
    <sql><![CDATA[
      ALTER TABLE `services_citys` CHANGE COLUMN `service_name` `service_name` VARCHAR(255) NOT NULL  ;
    ]]></sql>
  </changeSet>
  <changeSet id="2014-10-29-01" author="mrk">
    <sql><![CDATA[
      ALTER TABLE `params`
        ADD COLUMN `name` VARCHAR(255) NOT NULL DEFAULT '' AFTER `value`,
        ADD COLUMN `description` VARCHAR(1023) NOT NULL DEFAULT '' AFTER `name`;
    ]]></sql>
  </changeSet>
  <changeSet id="2014-10-29-02" author="mrk">
    <sql><![CDATA[
      INSERT INTO `params` (`id`, `value`, `name`, `description`) VALUES (1, '', 'SMS_TO_CLIENTS', '')   ON DUPLICATE KEY UPDATE `name` = 'SMS_TO_CLIENTS';
      INSERT INTO `params` (`id`, `value`, `name`, `description`) VALUES (2, '', 'SMS_TO_EXUCATORS', '')   ON DUPLICATE KEY UPDATE `name` = 'SMS_TO_EXUCATORS';
      INSERT INTO `params` (`id`, `value`, `name`, `description`) VALUES (3, '', 'BLACK_LIST_MANAGER_NOTIFY_EMAIL', '')   ON DUPLICATE KEY UPDATE `name` = 'BLACK_LIST_MANAGER_NOTIFY_EMAIL';
      INSERT INTO `params` (`id`, `value`, `name`, `description`) VALUES (4, '', 'DEFAULT_SMS_GATEWAY', '')   ON DUPLICATE KEY UPDATE `name` = 'DEFAULT_SMS_GATEWAY';
      INSERT INTO `params` (`id`, `value`, `name`, `description`) VALUES (5, '', 'OSMP_BALANCE', '')   ON DUPLICATE KEY UPDATE `name` = 'OSMP_BALANCE';
      INSERT INTO `params` (`id`, `value`, `name`, `description`) VALUES (6, '', 'CALC_DEFAULT_ACTIVE', '')   ON DUPLICATE KEY UPDATE `name` = 'CALC_DEFAULT_ACTIVE';
      INSERT INTO `params` (`id`, `value`, `name`, `description`) VALUES (7, '', 'CALC_CAN_DISABLED', '')   ON DUPLICATE KEY UPDATE `name` = 'CALC_CAN_DISABLED';
      INSERT INTO `params` (`id`, `value`, `name`, `description`) VALUES (8, '', 'MOBW_BALANCE', '')   ON DUPLICATE KEY UPDATE `name` = 'MOBW_BALANCE';
      INSERT INTO `params` (`id`, `value`, `name`, `description`) VALUES (9, '', 'REPORTS_OPERATORS_PRICES', '')   ON DUPLICATE KEY UPDATE `name` = 'REPORTS_OPERATORS_PRICES';
      INSERT INTO `params` (`id`, `value`, `name`, `description`) VALUES (10, '', 'CLIENTS_PRIORITY_ORDERS_COUNT', '')   ON DUPLICATE KEY UPDATE `name` = 'CLIENTS_PRIORITY_ORDERS_COUNT';
      INSERT INTO `params` (`id`, `value`, `name`, `description`) VALUES (11, '', 'CLIENT_TRIP_COUNT_ABOVE', '')   ON DUPLICATE KEY UPDATE `name` = 'CLIENT_TRIP_COUNT_ABOVE';
      INSERT INTO `params` (`id`, `value`, `name`, `description`) VALUES (12, '', 'CLIENT_TRIP_30_DAYS_SUM_ABOVE', '')   ON DUPLICATE KEY UPDATE `name` = 'CLIENT_TRIP_30_DAYS_SUM_ABOVE';
      INSERT INTO `params` (`id`, `value`, `name`, `description`) VALUES (13, '', 'CLIENT_TRIP_30_DAYS_COUNT_ABOVE', '')   ON DUPLICATE KEY UPDATE `name` = 'CLIENT_TRIP_30_DAYS_COUNT_ABOVE';
      INSERT INTO `params` (`id`, `value`, `name`, `description`) VALUES (14, '', 'CLIENT_TRIP_CREDIT_PERCENT', '')   ON DUPLICATE KEY UPDATE `name` = 'CLIENT_TRIP_CREDIT_PERCENT';
      INSERT INTO `params` (`id`, `value`, `name`, `description`) VALUES (15, '', 'QUALITY_CONTROL_DEP_EMAIL', '')   ON DUPLICATE KEY UPDATE `name` = 'QUALITY_CONTROL_DEP_EMAIL';
      INSERT INTO `params` (`id`, `value`, `name`, `description`) VALUES (16, '', 'PARTNERS_REQ_INFO_ACTIVE', '')   ON DUPLICATE KEY UPDATE `name` = 'PARTNERS_REQ_INFO_ACTIVE';
      INSERT INTO `params` (`id`, `value`, `name`, `description`) VALUES (17, '', 'CLIENT_SMS_FORMAT', '')   ON DUPLICATE KEY UPDATE `name` = 'CLIENT_SMS_FORMAT';
      INSERT INTO `params` (`id`, `value`, `name`, `description`) VALUES (18, '', 'PC_SUPERVISOR', '')   ON DUPLICATE KEY UPDATE `name` = 'PC_SUPERVISOR';
      INSERT INTO `params` (`id`, `value`, `name`, `description`) VALUES (19, '', 'AUTO_TTS_CARREADY', '')   ON DUPLICATE KEY UPDATE `name` = 'AUTO_TTS_CARREADY';
      INSERT INTO `params` (`id`, `value`, `name`, `description`) VALUES (20, '', 'CLIENT_TTS_FORMAT', '')   ON DUPLICATE KEY UPDATE `name` = 'CLIENT_TTS_FORMAT';
      INSERT INTO `params` (`id`, `value`, `name`, `description`) VALUES (21, '', 'SMS_NONCLIENT_AFTERORDER', '')   ON DUPLICATE KEY UPDATE `name` = 'SMS_NONCLIENT_AFTERORDER';
      INSERT INTO `params` (`id`, `value`, `name`, `description`) VALUES (22, '', 'CAR_OPEN_CLOSE_MANAGER_NOTIFY_EMAIL', '')   ON DUPLICATE KEY UPDATE `name` = 'CAR_OPEN_CLOSE_MANAGER_NOTIFY_EMAIL';
      INSERT INTO `params` (`id`, `value`, `name`, `description`) VALUES (23, '', 'J2ME_DRIVER_APP_VERSION', '')   ON DUPLICATE KEY UPDATE `name` = 'J2ME_DRIVER_APP_VERSION';
      INSERT INTO `params` (`id`, `value`, `name`, `description`) VALUES (24, '', 'J2ME_DRIVER_APP_DLOAD_URL', '')   ON DUPLICATE KEY UPDATE `name` = 'J2ME_DRIVER_APP_DLOAD_URL';
      INSERT INTO `params` (`id`, `value`, `name`, `description`) VALUES (25, '', 'ENABLE_GOOD_MAN_ACTION', '')   ON DUPLICATE KEY UPDATE `name` = 'ENABLE_GOOD_MAN_ACTION';
      INSERT INTO `params` (`id`, `value`, `name`, `description`) VALUES (26, '', 'GOOD_MAN_ACTION_BONUS', '')   ON DUPLICATE KEY UPDATE `name` = 'GOOD_MAN_ACTION_BONUS';
      INSERT INTO `params` (`id`, `value`, `name`, `description`) VALUES (27, '', 'GOOD_MAN_ACTION_BONUS_PERIOD', '')   ON DUPLICATE KEY UPDATE `name` = 'GOOD_MAN_ACTION_BONUS_PERIOD';
      INSERT INTO `params` (`id`, `value`, `name`, `description`) VALUES (28, '', 'PUT_ON_TIME_INST', '')   ON DUPLICATE KEY UPDATE `name` = 'PUT_ON_TIME_INST';
      INSERT INTO `params` (`id`, `value`, `name`, `description`) VALUES (29, '', 'GPS_TIMEOUT', '')   ON DUPLICATE KEY UPDATE `name` = 'GPS_TIMEOUT';
      INSERT INTO `params` (`id`, `value`, `name`, `description`) VALUES (30, '', 'GPS_DISTANCE', '')   ON DUPLICATE KEY UPDATE `name` = 'GPS_DISTANCE';
      INSERT INTO `params` (`id`, `value`, `name`, `description`) VALUES (31, '', 'MINUTE_PRICE_PENALTY_CONDITION', '')   ON DUPLICATE KEY UPDATE `name` = 'MINUTE_PRICE_PENALTY_CONDITION';
      INSERT INTO `params` (`id`, `value`, `name`, `description`) VALUES (32, '', 'COST_PENALTY_SMS_TEXT', '')   ON DUPLICATE KEY UPDATE `name` = 'COST_PENALTY_SMS_TEXT';
      INSERT INTO `params` (`id`, `value`, `name`, `description`) VALUES (33, '', 'COST_PENALTY_AMOUNT', '')   ON DUPLICATE KEY UPDATE `name` = 'COST_PENALTY_AMOUNT';
      INSERT INTO `params` (`id`, `value`, `name`, `description`) VALUES (34, '', 'WIKI_URL', '')   ON DUPLICATE KEY UPDATE `name` = 'WIKI_URL';
      INSERT INTO `params` (`id`, `value`, `name`, `description`) VALUES (35, '', 'AUTO_ASSIGN_CAR', '')   ON DUPLICATE KEY UPDATE `name` = 'AUTO_ASSIGN_CAR';
      INSERT INTO `params` (`id`, `value`, `name`, `description`) VALUES (36, '', 'SEND_SMS_AFTER_REGISTER', '')   ON DUPLICATE KEY UPDATE `name` = 'SEND_SMS_AFTER_REGISTER';
      INSERT INTO `params` (`id`, `value`, `name`, `description`) VALUES (37, '', 'SMS_WAITING_INTERVAL_BEFORE', '')   ON DUPLICATE KEY UPDATE `name` = 'SMS_WAITING_INTERVAL_BEFORE';
      INSERT INTO `params` (`id`, `value`, `name`, `description`) VALUES (38, '', 'SMS_WAITING_INTERVAL_BETWEEN', '')   ON DUPLICATE KEY UPDATE `name` = 'SMS_WAITING_INTERVAL_BETWEEN';
      INSERT INTO `params` (`id`, `value`, `name`, `description`) VALUES (39, '', 'SMS_WAITING_FOR_DELIVERY_RECEIPT', '')   ON DUPLICATE KEY UPDATE `name` = 'SMS_WAITING_FOR_DELIVERY_RECEIPT';
      INSERT INTO `params` (`id`, `value`, `name`, `description`) VALUES (40, '', 'AGENTS_COUNT_RED_ALARM', '')   ON DUPLICATE KEY UPDATE `name` = 'AGENTS_COUNT_RED_ALARM';
      INSERT INTO `params` (`id`, `value`, `name`, `description`) VALUES (41, '', 'ENABLE_ORDERS_VALIDATION', '')   ON DUPLICATE KEY UPDATE `name` = 'ENABLE_ORDERS_VALIDATION';
      INSERT INTO `params` (`id`, `value`, `name`, `description`) VALUES (42, '', 'USE_PRECALCULATED_PRICE', '')   ON DUPLICATE KEY UPDATE `name` = 'USE_PRECALCULATED_PRICE';
      INSERT INTO `params` (`id`, `value`, `name`, `description`) VALUES (43, '', 'J2ME_DRIVER_SESSION_TIMEOUT', '')   ON DUPLICATE KEY UPDATE `name` = 'J2ME_DRIVER_SESSION_TIMEOUT';
      INSERT INTO `params` (`id`, `value`, `name`, `description`) VALUES (44, '', 'J2ME_DRIVER_ORDER_INTERACTIVE', '')   ON DUPLICATE KEY UPDATE `name` = 'J2ME_DRIVER_ORDER_INTERACTIVE';
      INSERT INTO `params` (`id`, `value`, `name`, `description`) VALUES (45, '', 'DRIVER_ACTION_AFTER_ORDER_REFUSAL', '')   ON DUPLICATE KEY UPDATE `name` = 'DRIVER_ACTION_AFTER_ORDER_REFUSAL';
      INSERT INTO `params` (`id`, `value`, `name`, `description`) VALUES (46, '', 'J2ME_DRIVER_ORDER_ACCEPT_TIMEOUT', '')   ON DUPLICATE KEY UPDATE `name` = 'J2ME_DRIVER_ORDER_ACCEPT_TIMEOUT';
      INSERT INTO `params` (`id`, `value`, `name`, `description`) VALUES (47, '', 'CLIENTS_DISABLED_SDACHA', '')   ON DUPLICATE KEY UPDATE `name` = 'CLIENTS_DISABLED_SDACHA';
      INSERT INTO `params` (`id`, `value`, `name`, `description`) VALUES (48, '', 'EXECUTORS_DISABLED_LOAN', '')   ON DUPLICATE KEY UPDATE `name` = 'EXECUTORS_DISABLED_LOAN';
      INSERT INTO `params` (`id`, `value`, `name`, `description`) VALUES (49, '', 'TAXI_ENABLE_SELFTAKING', '')   ON DUPLICATE KEY UPDATE `name` = 'TAXI_ENABLE_SELFTAKING';
      INSERT INTO `params` (`id`, `value`, `name`, `description`) VALUES (50, '', 'J2ME_ENABLE_NEW_ORDERS_NOTIFY', '')   ON DUPLICATE KEY UPDATE `name` = 'J2ME_ENABLE_NEW_ORDERS_NOTIFY';
      INSERT INTO `params` (`id`, `value`, `name`, `description`) VALUES (51, '', 'J2ME_NEW_ORDERS_NOTIFY_DELAY_SECONDS', '')   ON DUPLICATE KEY UPDATE `name` = 'J2ME_NEW_ORDERS_NOTIFY_DELAY_SECONDS';
      INSERT INTO `params` (`id`, `value`, `name`, `description`) VALUES (52, '', 'SMTP_SERVER', '')   ON DUPLICATE KEY UPDATE `name` = 'SMTP_SERVER';
      INSERT INTO `params` (`id`, `value`, `name`, `description`) VALUES (53, '', 'ORDERS_DISPATCHING_REASSIGN_ENABLE', '')   ON DUPLICATE KEY UPDATE `name` = 'ORDERS_DISPATCHING_REASSIGN_ENABLE';
      INSERT INTO `params` (`id`, `value`, `name`, `description`) VALUES (54, '', 'ORDERS_DISPATCHING_REASSING_TIME_SLICE', '')   ON DUPLICATE KEY UPDATE `name` = 'ORDERS_DISPATCHING_REASSING_TIME_SLICE';
      INSERT INTO `params` (`id`, `value`, `name`, `description`) VALUES (55, '', 'ORDERS_DISPATCHING_REASSIGN_DELAY', '')   ON DUPLICATE KEY UPDATE `name` = 'ORDERS_DISPATCHING_REASSIGN_DELAY';
      INSERT INTO `params` (`id`, `value`, `name`, `description`) VALUES (56, '', 'NIGHTDISCOUNT_ENABLE', '')   ON DUPLICATE KEY UPDATE `name` = 'NIGHTDISCOUNT_ENABLE';
      INSERT INTO `params` (`id`, `value`, `name`, `description`) VALUES (57, '', 'NIGHTDISCOUNT_TIME_FROM', '')   ON DUPLICATE KEY UPDATE `name` = 'NIGHTDISCOUNT_TIME_FROM';
      INSERT INTO `params` (`id`, `value`, `name`, `description`) VALUES (58, '', 'NIGHTDISCOUNT_TIME_TILL', '')   ON DUPLICATE KEY UPDATE `name` = 'NIGHTDISCOUNT_TIME_TILL';
      INSERT INTO `params` (`id`, `value`, `name`, `description`) VALUES (59, '', 'NIGHTDISCOUNT_AMOUNT', '')   ON DUPLICATE KEY UPDATE `name` = 'NIGHTDISCOUNT_AMOUNT';
      INSERT INTO `params` (`id`, `value`, `name`, `description`) VALUES (60, '', 'NIGHTDISCOUNT_AMOUNT_TYPE', '')   ON DUPLICATE KEY UPDATE `name` = 'NIGHTDISCOUNT_AMOUNT_TYPE';
      INSERT INTO `params` (`id`, `value`, `name`, `description`) VALUES (61, '', 'BIRTHDATE_SMS_SEND_ENABLE', '')   ON DUPLICATE KEY UPDATE `name` = 'BIRTHDATE_SMS_SEND_ENABLE';
      INSERT INTO `params` (`id`, `value`, `name`, `description`) VALUES (62, '', 'BIRTHDATE_SMS_TEXT', '')   ON DUPLICATE KEY UPDATE `name` = 'BIRTHDATE_SMS_TEXT';
      INSERT INTO `params` (`id`, `value`, `name`, `description`) VALUES (63, '', 'BIRTHDATE_ORDER_DISCOUNT_ENABLE', '')   ON DUPLICATE KEY UPDATE `name` = 'BIRTHDATE_ORDER_DISCOUNT_ENABLE';
      INSERT INTO `params` (`id`, `value`, `name`, `description`) VALUES (64, '', 'BIRTHDATE_ORDER_DISCOUNT_AMOUNT', '')   ON DUPLICATE KEY UPDATE `name` = 'BIRTHDATE_ORDER_DISCOUNT_AMOUNT';
      INSERT INTO `params` (`id`, `value`, `name`, `description`) VALUES (65, '', 'ASTERISKDB_HOST', '')   ON DUPLICATE KEY UPDATE `name` = 'ASTERISKDB_HOST';
      INSERT INTO `params` (`id`, `value`, `name`, `description`) VALUES (66, '', 'ASTERISKDB_USER', '')   ON DUPLICATE KEY UPDATE `name` = 'ASTERISKDB_USER';
      INSERT INTO `params` (`id`, `value`, `name`, `description`) VALUES (67, '', 'ASTERISKDB_PASSWORD', '')   ON DUPLICATE KEY UPDATE `name` = 'ASTERISKDB_PASSWORD';
      INSERT INTO `params` (`id`, `value`, `name`, `description`) VALUES (68, '', 'ASTERISKDB_DBNAME', '')   ON DUPLICATE KEY UPDATE `name` = 'ASTERISKDB_DBNAME';
      INSERT INTO `params` (`id`, `value`, `name`, `description`) VALUES (69, '', 'SMS_SEND_ALLOW_FROM', '')   ON DUPLICATE KEY UPDATE `name` = 'SMS_SEND_ALLOW_FROM';
      INSERT INTO `params` (`id`, `value`, `name`, `description`) VALUES (70, '', 'J2ME_SHOW_ORDERS_TO_TIME', '')   ON DUPLICATE KEY UPDATE `name` = 'J2ME_SHOW_ORDERS_TO_TIME';
      INSERT INTO `params` (`id`, `value`, `name`, `description`) VALUES (71, '', 'EXECUTORS_DECLINE_GO_AWAY_HOURS', '')   ON DUPLICATE KEY UPDATE `name` = 'EXECUTORS_DECLINE_GO_AWAY_HOURS';
      INSERT INTO `params` (`id`, `value`, `name`, `description`) VALUES (72, '', 'ASTERISK_AMI_HOST', '')   ON DUPLICATE KEY UPDATE `name` = 'ASTERISK_AMI_HOST';
      INSERT INTO `params` (`id`, `value`, `name`, `description`) VALUES (73, '', 'ASTERISK_AMI_PORT', '')   ON DUPLICATE KEY UPDATE `name` = 'ASTERISK_AMI_PORT';
      INSERT INTO `params` (`id`, `value`, `name`, `description`) VALUES (74, '', 'ASTERISK_AMI_USER', '')   ON DUPLICATE KEY UPDATE `name` = 'ASTERISK_AMI_USER';
      INSERT INTO `params` (`id`, `value`, `name`, `description`) VALUES (75, '', 'ASTERISK_AMI_PASSWORD', '')   ON DUPLICATE KEY UPDATE `name` = 'ASTERISK_AMI_PASSWORD';
      INSERT INTO `params` (`id`, `value`, `name`, `description`) VALUES (76, '', 'CONFIRM_CALL_LONG_WAIT', '')   ON DUPLICATE KEY UPDATE `name` = 'CONFIRM_CALL_LONG_WAIT';
      INSERT INTO `params` (`id`, `value`, `name`, `description`) VALUES (77, '', 'TAXI_AUTO_DISPATCHER', '')   ON DUPLICATE KEY UPDATE `name` = 'TAXI_AUTO_DISPATCHER';
      INSERT INTO `params` (`id`, `value`, `name`, `description`) VALUES (78, '', 'ORDER_CANCEL_DEFAULT_CLIENT_SMS_TEXT', '')   ON DUPLICATE KEY UPDATE `name` = 'ORDER_CANCEL_DEFAULT_CLIENT_SMS_TEXT';
      INSERT INTO `params` (`id`, `value`, `name`, `description`) VALUES (79, '', 'ORDER_CANCEL_SEND_SMS_IF_CLIENT_DIDNT_GET_OUT', '')   ON DUPLICATE KEY UPDATE `name` = 'ORDER_CANCEL_SEND_SMS_IF_CLIENT_DIDNT_GET_OUT';
      INSERT INTO `params` (`id`, `value`, `name`, `description`) VALUES (80, '', 'ORDER_CANCEL_SEND_SMS_IF_CLIENT_DIDNT_WAIT', '')   ON DUPLICATE KEY UPDATE `name` = 'ORDER_CANCEL_SEND_SMS_IF_CLIENT_DIDNT_WAIT';
      INSERT INTO `params` (`id`, `value`, `name`, `description`) VALUES (81, '', 'SORT_ORDERS_BY_INCOMING_PHONE_LINES', '')   ON DUPLICATE KEY UPDATE `name` = 'SORT_ORDERS_BY_INCOMING_PHONE_LINES';
      INSERT INTO `params` (`id`, `value`, `name`, `description`) VALUES (82, '', 'SHORT_TAXI_TABLE', '')   ON DUPLICATE KEY UPDATE `name` = 'SHORT_TAXI_TABLE';
      INSERT INTO `params` (`id`, `value`, `name`, `description`) VALUES (83, '', 'SHOW_RSDRIVER_ICON_IN_TAXI_TABLE', '')   ON DUPLICATE KEY UPDATE `name` = 'SHOW_RSDRIVER_ICON_IN_TAXI_TABLE';
      INSERT INTO `params` (`id`, `value`, `name`, `description`) VALUES (84, '', 'BIRTHDATE_SMS_HOUR', '')   ON DUPLICATE KEY UPDATE `name` = 'BIRTHDATE_SMS_HOUR';
      INSERT INTO `params` (`id`, `value`, `name`, `description`) VALUES (85, '', 'BIRTHDATE_SMS_MINUTE', '')   ON DUPLICATE KEY UPDATE `name` = 'BIRTHDATE_SMS_MINUTE';
      INSERT INTO `params` (`id`, `value`, `name`, `description`) VALUES (86, '', 'CLIENT_ORDER_SMS_ON_SET_EXECUTOR', '')   ON DUPLICATE KEY UPDATE `name` = 'CLIENT_ORDER_SMS_ON_SET_EXECUTOR';
      INSERT INTO `params` (`id`, `value`, `name`, `description`) VALUES (87, '', 'SMS_TRANSLIT_BY_DEFAULT', '')   ON DUPLICATE KEY UPDATE `name` = 'SMS_TRANSLIT_BY_DEFAULT';
      INSERT INTO `params` (`id`, `value`, `name`, `description`) VALUES (88, '', 'SHOW_INCOMING_PHONE_LINE_IN_MOBILE_APP', '')   ON DUPLICATE KEY UPDATE `name` = 'SHOW_INCOMING_PHONE_LINE_IN_MOBILE_APP';
      INSERT INTO `params` (`id`, `value`, `name`, `description`) VALUES (89, '', 'MOBILE_APP_GET_EXCHANGE_ORDERS_LIMIT', '')   ON DUPLICATE KEY UPDATE `name` = 'MOBILE_APP_GET_EXCHANGE_ORDERS_LIMIT';
      INSERT INTO `params` (`id`, `value`, `name`, `description`) VALUES (90, '', 'SET_EXECUTOR_SECOND_ORDER_WARNING_DISABLE', '')   ON DUPLICATE KEY UPDATE `name` = 'SET_EXECUTOR_SECOND_ORDER_WARNING_DISABLE';
      INSERT INTO `params` (`id`, `value`, `name`, `description`) VALUES (91, '', 'ORDER_CANCEL_ALLOW_SEND_SMS', '')   ON DUPLICATE KEY UPDATE `name` = 'ORDER_CANCEL_ALLOW_SEND_SMS';
      INSERT INTO `params` (`id`, `value`, `name`, `description`) VALUES (92, '', 'MOBILE_APP_ALLOW_CALL_TO_CLIENT', '')   ON DUPLICATE KEY UPDATE `name` = 'MOBILE_APP_ALLOW_CALL_TO_CLIENT';
      INSERT INTO `params` (`id`, `value`, `name`, `description`) VALUES (93, '', 'CLIENT_LONG_DRIVER_WAIT_REPEAT_NOTIFY', '')   ON DUPLICATE KEY UPDATE `name` = 'CLIENT_LONG_DRIVER_WAIT_REPEAT_NOTIFY';
      INSERT INTO `params` (`id`, `value`, `name`, `description`) VALUES (94, '', 'WARN_IF_SIMILAR_ORDERS', '')   ON DUPLICATE KEY UPDATE `name` = 'WARN_IF_SIMILAR_ORDERS';
    ]]></sql>
  </changeSet>
  <changeSet id="2014-12-10-01" author="kae">
    <sql><![CDATA[
      ALTER TABLE `street_direction` 
        DROP PRIMARY KEY,
        ADD PRIMARY KEY USING BTREE (`street`, `start`, `end`, `direction`, `corpus`, `city`);
    ]]></sql>
  </changeSet>
  <changeSet id="2014-12-17-01" author="kae">
    <sql><![CDATA[
      ALTER TABLE `zakazi`
        ADD COLUMN `original_service` INT(11) NOT NULL DEFAULT '0' AFTER `napr_from_city`;
    ]]></sql>
  </changeSet>
  <changeSet id="2014-12-17-02" author="kae">
    <sql><![CDATA[
      UPDATE `zakazi` SET `original_service` = `napr_from_city`;
    ]]></sql>
  </changeSet>
  <changeSet id="2014-12-17-03" author="kae">
    <sql><![CDATA[
      ALTER TABLE `zakazi_online`
        ADD COLUMN `original_service` INT(11) NOT NULL DEFAULT '0' AFTER `napr_from_city`;
    ]]></sql>
  </changeSet>
  <changeSet id="2014-12-17-04" author="kae">
    <sql><![CDATA[
      UPDATE `zakazi_online` SET `original_service` = `napr_from_city`;
    ]]></sql>
  </changeSet>
  <changeSet id="2014-12-19-01" author="rp">
    <sql><![CDATA[
      ALTER TABLE `work_channels` ADD COLUMN `delay` INT(10) NOT NULL DEFAULT '-1' AFTER `description`;
    ]]></sql>
  </changeSet>
  <changeSet id="2014-02-05-01" author="mrk">
    <sql><![CDATA[
      CREATE TABLE `order_transfer_options` (
          `id` INT(10) UNSIGNED NOT NULL AUTO_INCREMENT,
          `city_from` INT(10) UNSIGNED NOT NULL DEFAULT '0',
          `city_to` INT(10) UNSIGNED NOT NULL DEFAULT '0',
          `priority` INT(10) UNSIGNED NOT NULL DEFAULT '0',
          `timeout` INT(10) UNSIGNED NOT NULL DEFAULT '0',
          `no_cars_on_map_toggle` INT(1) UNSIGNED NOT NULL DEFAULT '0',
          PRIMARY KEY (`id`),
          UNIQUE INDEX `id_UNIQUE` (`id` ASC))
        ENGINE = MyISAM
        DEFAULT CHARACTER SET = utf8;
    ]]></sql>
  </changeSet>
  <changeSet id="2014-02-05-02" author="mrk">
    <sql><![CDATA[
      INSERT INTO `params` SET `id` = 97, `value` = '0', `name` = 'AUTO_ORDER_TRANSFER';
    ]]></sql>
  </changeSet>
  <changeSet id="2014-02-05-03" author="mrk">
    <sql><![CDATA[
      ALTER TABLE `zakazi_online`
        ADD COLUMN `time_transfered` TIMESTAMP NOT NULL DEFAULT '0000-00-00 00:00:00' AFTER `kvrem`;
    ]]></sql>
  </changeSet>
  <changeSet id="2014-02-11-01" author="mrk">
    <sql><![CDATA[
      ALTER TABLE `zakazi_locks`
        ADD COLUMN `ref_type` INT NOT NULL DEFAULT '0' AFTER `user`,
        ADD COLUMN `ref_id` INT NOT NULL DEFAULT '0' AFTER `ref_type`;
    ]]></sql>
  </changeSet>
  <changeSet id="2014-02-27-01" author="mrk">
    <sql><![CDATA[
      ALTER TABLE `zakazi_locks`
        ADD COLUMN `token` VARCHAR(32) NOT NULL AFTER `user`;
    ]]></sql>
  </changeSet>
  <changeSet id="2015-03-02-01" author="kae">
    <sql><![CDATA[
      CREATE TABLE `client_phone_bind_code` (
        `phone` VARCHAR(15) NOT NULL,
        `code` VARCHAR(8) NOT NULL,
        `created` DATETIME NOT NULL,
        PRIMARY KEY (`phone`));
    ]]></sql>
  </changeSet>
  <changeSet id="2015-03-03-01" author="kae">
    <sql><![CDATA[
      CREATE TABLE `client_auth_token` (
        `client_id` INT NOT NULL,
        `token` VARCHAR(32) NOT NULL,
        `created` DATETIME NOT NULL,
        PRIMARY KEY (`client_id`),
        UNIQUE INDEX `client_auth_token_ui1` (`token` ASC));
    ]]></sql>
  </changeSet>
  <changeSet id="2015-03-04-01" author="kae">
    <sql><![CDATA[
      DELETE FROM `client_auth_token`;
    ]]></sql>
  </changeSet>
  <changeSet id="2015-03-04-02" author="kae">
    <sql><![CDATA[
      ALTER TABLE `client_auth_token`
        ADD COLUMN `phone` VARCHAR(15) NOT NULL AFTER `client_id`;
    ]]></sql>
  </changeSet>
  <changeSet id="2015-03-06-01" author="kae">
    <sql><![CDATA[
      ALTER TABLE `zakazi`
        ADD COLUMN location_time DATETIME NULL,
        ADD COLUMN latitude DECIMAL(12, 9) NULL,
        ADD COLUMN longitude DECIMAL(12, 9) NULL,
        ADD COLUMN location_accuracy DECIMAL(10, 2) NULL;
    ]]></sql>
  </changeSet>
  <changeSet id="2015-03-06-02" author="kae">
    <sql><![CDATA[
      ALTER TABLE `zakazi_archive`
        ADD COLUMN location_time DATETIME NULL,
        ADD COLUMN latitude DECIMAL(12, 9) NULL,
        ADD COLUMN longitude DECIMAL(12, 9) NULL,
        ADD COLUMN location_accuracy DECIMAL(10, 2) NULL;
    ]]></sql>
  </changeSet>
  <changeSet id="2015-04-02-01" author="rp">
    <sql><![CDATA[
      ALTER TABLE `standard_client_bonus_settings` ADD COLUMN `akciya` INT NOT NULL DEFAULT 0 AFTER `friend_bonus_size`;
    ]]></sql>
  </changeSet>
  <changeSet id="2015-04-19-01" author="kae">
    <sql><![CDATA[
      CREATE TABLE `executor_penalty` (
        `id` int(11) NOT NULL AUTO_INCREMENT,
        `code` char(20) DEFAULT '',
        `name` char(100) DEFAULT '',
        `sum` double(10,2) DEFAULT '0.00',
        `close_sign` smallint(6) DEFAULT '0',
        `block_period` date DEFAULT '0000-00-00',
        `admin_sign` smallint(6) DEFAULT '0',
        `service` int(11) DEFAULT '0',
        `type_exec` int(11) DEFAULT '0',
        PRIMARY KEY (`id`)
      ) ENGINE=InnoDB AUTO_INCREMENT=7 DEFAULT CHARSET=utf8;
    ]]></sql>
  </changeSet>
  <changeSet id="2015-04-19-02" author="kae">
    <sql><![CDATA[
      CREATE TABLE `executor_penalty_connection` (
        `id_exec` int(11) DEFAULT '0',
        `id_penalty` int(11) DEFAULT '0',
        `user` char(64) DEFAULT '',
        `date_pen` date DEFAULT '0000-00-00',
        `text_pen` char(255) DEFAULT '',
        KEY `INDEX_1` (`id_exec`)
      ) ENGINE=InnoDB DEFAULT CHARSET=utf8;
    ]]></sql>
  </changeSet>
  <changeSet id="2015-05-06-01" author="kae">
    <sql>
      <![CDATA[
      UPDATE `executor_penalty` SET `block_period`=NULL ;
    ]]></sql>
  </changeSet>
  <changeSet id="2015-05-06-02" author="kae">
    <sql>
      <![CDATA[
      ALTER TABLE `executor_penalty` 
        CHANGE COLUMN `block_period` `block_period` INT(11) NULL DEFAULT '0' ;
    ]]></sql>
  </changeSet>
  <changeSet id="2015-05-07-01" author="kae">
    <sql><![CDATA[
      DELETE FROM `executor_penalty_connection`;
    ]]></sql>
  </changeSet>
  <changeSet id="2015-05-07-02" author="kae">
    <sql>
      <![CDATA[
      ALTER TABLE `executor_penalty_connection` 
        CHANGE COLUMN `id_exec` `executor_id` INT(11) NOT NULL ,
        CHANGE COLUMN `id_penalty` `penalty_id` INT(11) NOT NULL ,
        CHANGE COLUMN `user` `user` CHAR(64) NOT NULL ,
        CHANGE COLUMN `date_pen` `imposed_time` DATETIME NOT NULL ,
        CHANGE COLUMN `text_pen` `comment` CHAR(255) NOT NULL ,
        ADD COLUMN `id` INT(11) NOT NULL FIRST,
        ADD PRIMARY KEY (`id`),
        DROP INDEX `INDEX_1` , RENAME TO `imposed_executor_penalty` ;
    ]]></sql>
  </changeSet>
  <changeSet id="2015-05-07-03" author="kae">
    <sql><![CDATA[
      ALTER TABLE `imposed_executor_penalty` 
        CHANGE COLUMN `id` `id` INT(11) NOT NULL AUTO_INCREMENT ;
    ]]></sql>
  </changeSet>
  <changeSet id="2015-05-07-04" author="kae">
    <sql><![CDATA[
      ALTER TABLE `vodils` 
        ADD COLUMN `block_till` DATETIME NULL ;
    ]]></sql>
  </changeSet>
  <changeSet id="2015-05-08-01" author="rp">
    <sql><![CDATA[
      ALTER TABLE `zakazi_archive`
        ADD COLUMN `original_service` INT(11) NOT NULL DEFAULT '0' AFTER `napr_from_city`;
      UPDATE `zakazi_archive` SET `original_service` = `napr_from_city`;
    ]]></sql>
  </changeSet>
  <changeSet id="2015-05-12-01" author="kae">
    <sql><![CDATA[
      INSERT INTO `params` (`id`, `value`, `name`) 
        VALUES ('102', 'Ваш логин и пароль: {login} {password}', 'SMS_WITH_EXECUTOR_CREDENTIALS');
    ]]></sql>
  </changeSet>
  <changeSet id="2015-05-13-01" author="kae">
    <sql>
      <![CDATA[
      ALTER TABLE `vodils` 
        ADD COLUMN `admin_unlock` TINYINT(1) NULL ;
    ]]></sql>
  </changeSet>
  <changeSet id="2015-05-18-01" author="kae">
    <sql><![CDATA[
      ALTER TABLE `vodils`
        CHANGE COLUMN `block_when_balance_bellow` `block_when_balance_below` INT(10) UNSIGNED NULL DEFAULT NULL ;
    ]]></sql>
  </changeSet>
  <changeSet id="2015-05-18-02" author="kae">
    <sql><![CDATA[
      UPDATE `vodils` SET `block_when_balance_below`=NULL WHERE `block_when_balance_below`=0;
    ]]></sql>
  </changeSet>
  <changeSet id="2015-05-20-01" author="kae">
    <sql><![CDATA[
      CREATE TABLE `executor_schedule` (
        `id` INT NOT NULL AUTO_INCREMENT,
        `executor_id` INT NOT NULL,
        `weekday` TINYINT(1) NOT NULL,
        `start_time` TIME NOT NULL,
        `end_time` TIME NOT NULL,
        `charge_withdraw` TINYINT(1) NOT NULL DEFAULT 0,
        `absence_penalty` TINYINT(1) NOT NULL DEFAULT 0,
        PRIMARY KEY (`id`));
    ]]></sql>
  </changeSet>
  <changeSet id="2015-05-26-01" author="kae">
    <sql><![CDATA[
      ALTER TABLE `executor_schedule` 
        CHANGE COLUMN `absence_penalty` `absence_penalty` INT(11) NOT NULL DEFAULT '0' ;
    ]]></sql>
  </changeSet>
  <changeSet id="2015-05-27-01" author="kae">
    <sql><![CDATA[
      ALTER TABLE `executor_schedule`
        CHANGE COLUMN `absence_penalty` `absence_penalty_id` INT(11) NOT NULL DEFAULT '0' ;
    ]]></sql>
  </changeSet>
  <changeSet id="2015-06-04-01" author="rp">
    <sql><![CDATA[
	INSERT INTO `acl_rule` (`name`, `handle`) VALUES ('Создание отчётов', 'crm.reports');
	INSERT INTO `acl_rule` (`name`, `handle`) VALUES ('Отправка SMS', 'crm.send.sms');
    ]]></sql>
  </changeSet>
  <changeSet id="2015-06-10-01" author="dev1">
  <sql><![CDATA[
    ALTER TABLE vodils
      ADD COLUMN type_term TINYINT(1) NOT NULL DEFAULT 0;
  ]]></sql>
  </changeSet>
  <changeSet id="2015-06-11-01" author="dev1">
    <sql><![CDATA[
      INSERT INTO `params` (`id`, `value`, `name`) 
        VALUES ('103', '0', 'HIDE_PRICE');
    ]]></sql>
  </changeSet>
  <changeSet id="2015-06-11-02" author="dev1">
    <sql><![CDATA[
      INSERT INTO `params` (`id`, `value`, `name`) 
        VALUES ('104', '30', 'TIME_FOR_PRELIMINARY');
    ]]></sql>
  </changeSet>
  <changeSet id="2015-06-14-01" author="rp">
    <sql><![CDATA[
      ALTER TABLE `vodils` CHANGE COLUMN `block_when_balance_below` `block_when_balance_below` INT(10) NULL DEFAULT NULL ;
    ]]></sql>
  </changeSet>
  <changeSet id="2015-06-16-01" author="rp">
    <sql><![CDATA[
      INSERT INTO `params` (`id`, `value`, `name`) 
        VALUES ('105', '0', 'Не начислять на счет водителю компенсации за б\н поездки');
    ]]></sql>
  </changeSet>
  <changeSet id="2015-06-24-01" author="rp">
    <sql><![CDATA[
      INSERT INTO `params` (`id`, `value`, `name`) 
        VALUES ('106', '0', 'Не штрафовать водителей, отказавшихся от заказа при назначении низшему по очереди');
    ]]></sql>
  </changeSet>
  <changeSet id="2015-06-23-01" author="dev1">
  <sql><![CDATA[
    ALTER TABLE zakazi
      ADD COLUMN reserve_car INT NOT NULL DEFAULT 0;
  ]]></sql>
  </changeSet>
  <changeSet id="2015-07-20-01" author="rp">
  <sql><![CDATA[
    INSERT INTO `services_citys` (`id`, `name`, `service_name`) VALUES ('37', 'Тутаев', 'Такcи Центр (Тутаев)');
  ]]></sql>
  </changeSet>
  <changeSet id="2015-07-24-01" author="dev1">
    <sql><![CDATA[
      INSERT INTO `params` (`id`, `value`, `name`) 
        VALUES ('107', '1', 'NEW_ORDER_WITH_INCOMPLETE');
    ]]></sql>
  </changeSet>
  <changeSet id="2015-08-06-01" author="dev1">
    <sql><![CDATA[
      ALTER TABLE `params`
        ADD COLUMN `service_id` INT NOT NULL DEFAULT 0;
    ]]></sql>
  </changeSet>
  <changeSet id="2015-08-07-01" author="rp">
    <sql><![CDATA[
ALTER TABLE `params` CHANGE COLUMN `service_id` `service_id` INT(11) NOT NULL DEFAULT '0' AFTER `id`, 
 DROP PRIMARY KEY,
 ADD PRIMARY KEY (`id`, `service_id`);
    ]]></sql>
  </changeSet>
  <changeSet id="2015-08-07-02" author="rp">
    <sql><![CDATA[
      ALTER TABLE `zakazi`
        ADD COLUMN `hide_order` INT NOT NULL DEFAULT 0;
    ]]></sql>
  </changeSet>
  <changeSet id="2015-08-12-01" author="dev1">
    <sql><![CDATA[
      DROP INDEX `PRIMARY` ON `client_auth_token`;
    ]]></sql>
  </changeSet>
  <changeSet id="2015-08-24-01" author="dev1">
    <sql><![CDATA[
	INSERT INTO `acl_rule` (`name`, `handle`) VALUES ('Изменение тарифного плана исполнителя', 'crm.manage.executors.changetariff');
	INSERT INTO `acl_rule` (`name`, `handle`) VALUES ('Начисление\Списание средств', 'crm.executors.payments');
    INSERT INTO `acl_user_group_has_rules` (`acl_user_group_id`, `acl_rule_id`) select id, (select id from acl_rule where handle = 'crm.manage.executors.changetariff') from `acl_user_group`;
    INSERT INTO `acl_user_group_has_rules` (`acl_user_group_id`, `acl_rule_id`) select id, (select id from acl_rule where handle = 'crm.executors.payments') from `acl_user_group`;
    ]]></sql>
  </changeSet>
  <changeSet id="2015-09-25-01" author="dev1">
    <sql><![CDATA[
	INSERT INTO `services_citys` (`id`, `name`, `service_name`) VALUES ('38', 'Атамановка', 'Атамановка');
    INSERT INTO `directions` (`id`, `name`, `order`, `city`, `type`, `parent`) VALUES ('100', 'Север',      '1', '38', '3', '0');
    INSERT INTO `directions` (`id`, `name`, `order`, `city`, `type`, `parent`) VALUES ('101', 'Кладбище',   '2', '38', '3', '100');
    INSERT INTO `directions` (`id`, `name`, `order`, `city`, `type`, `parent`) VALUES ('102', 'Пионерская', '3', '38', '3', '100');
    INSERT INTO `directions` (`id`, `name`, `order`, `city`, `type`, `parent`) VALUES ('110', 'Центр',      '4', '38', '3', '0');
    INSERT INTO `directions` (`id`, `name`, `order`, `city`, `type`, `parent`) VALUES ('111', 'Ключевая',   '5', '38', '3', '110');
    INSERT INTO `directions` (`id`, `name`, `order`, `city`, `type`, `parent`) VALUES ('112', 'Атамановка', '6', '38', '3', '110');
    INSERT INTO `directions` (`id`, `name`, `order`, `city`, `type`, `parent`) VALUES ('120', 'Юг',         '7', '38', '3', '0');
    INSERT INTO `directions` (`id`, `name`, `order`, `city`, `type`, `parent`) VALUES ('121', 'Ириничный',  '8', '38', '3', '120');
    INSERT INTO `directions` (`id`, `name`, `order`, `city`, `type`, `parent`) VALUES ('122', 'Дачный',     '9', '38', '3', '120');
    ]]></sql>
  </changeSet>
  <changeSet id="2015-10-01-01" author="dev1">
    <sql><![CDATA[
      INSERT INTO `cfg_setting` (`handle`, `val`) VALUES ('crm.map.type', 'ErpicoYMaps');
    ]]></sql>
  </changeSet>
  <changeSet id="2015-10-13-01" author="dev1">
    <sql><![CDATA[
      ALTER TABLE `services_citys`
        ADD COLUMN `country` VARCHAR(32) NOT NULL DEFAULT '',
        ADD COLUMN `region`  VARCHAR(32) NOT NULL DEFAULT '',
        ADD COLUMN `region_id` VARCHAR(16) NOT NULL DEFAULT '',
        ADD COLUMN `city_longitude` VARCHAR(16) NOT NULL DEFAULT '',
        ADD COLUMN `city_latitude` VARCHAR(16) NOT NULL DEFAULT '';
    ]]></sql>
  </changeSet>
  <changeSet id="2015-10-13-02" author="dev1">
    <sql><![CDATA[
      UPDATE `services_citys` set city_longitude = 51.928306, city_latitude = 113.632114 where UPPER(name) = 'АТАМАНОВКА';
    ]]></sql>
  </changeSet>
  <changeSet id="2015-10-14-01" author="rp">
  <sql><![CDATA[
    ALTER TABLE zakazi_archive
      ADD COLUMN reserve_car INT NOT NULL DEFAULT 0;
  ]]></sql>
  </changeSet>
  <changeSet id="2015-10-14-02" author="rp">
  <sql><![CDATA[
      ALTER TABLE `zakazi_archive`
        ADD COLUMN `hide_order` INT NOT NULL DEFAULT 0;
  ]]></sql>
  </changeSet>
  <changeSet id="2015-10-14-03" author="dev1">
    <sql><![CDATA[
      ALTER TABLE `adreses` ADD COLUMN `country` VARCHAR(32) NOT NULL DEFAULT '';
      ALTER TABLE `adreses_archive` ADD COLUMN `country` VARCHAR(32) NOT NULL DEFAULT '';
    ]]></sql>
  </changeSet>
  <changeSet id="2015-10-19-01" author="dev1">
    <sql><![CDATA[
      UPDATE `services_citys` set region_id = '75000000000', country = 'Россия', region = 'Забайкальский' where UPPER(name) = 'АТАМАНОВКА';
      UPDATE `services_citys` set region_id = '75000000000', country = 'Россия', region = 'Забайкальский' where UPPER(name) = 'КРАСНОКАМЕНСК';
      UPDATE `services_citys` set region_id = '75000000000', country = 'Россия', region = 'Забайкальский' where UPPER(name) = 'ЗАБАЙКАЛЬСК';
      UPDATE `services_citys` set region_id = '75000000000', country = 'Россия', region = 'Забайкальский' where UPPER(name) = 'ШЕРЛОВАЯ ГОРА';
      UPDATE `services_citys` set region_id = '75000000000', country = 'Россия', region = 'Забайкальский' where UPPER(name) = 'БОРЗЯ';
      UPDATE `services_citys` set region_id = '75000000000', country = 'Россия', region = 'Забайкальский' where UPPER(name) = 'ПРИАРГУНСК';
    ]]></sql>
  </changeSet>
  <changeSet id="2015-10-19-02" author="dev1">
    <sql><![CDATA[
      INSERT INTO `params` (id, value, name) values ('108', 'п,д,пгт,с', 'LOCALITY_TYPE');
    ]]></sql>
  </changeSet>
  <changeSet id="2015-10-20-01" author="dev1">
    <sql><![CDATA[
      UPDATE `params` set value = '\'п\',\'д\',\'пгт\',\'с\'' where id = 108;
    ]]></sql>
  </changeSet>
  <changeSet id="2015-10-26-01" author="dev1">
    <sql><![CDATA[
      UPDATE `services_citys` set region_id = '76000000000', country = 'Россия', region = 'Ярославская', city_longitude = '39.8736800', city_latitude = '57.6298700' where UPPER(name) = 'ЯРОСЛАВЛЬ';
      UPDATE `services_citys` set region_id = '76000000000', country = 'Россия', region = 'Ярославская', city_longitude = '39.5406000', city_latitude = '57.8852900' where UPPER(name) = 'ТУТАЕВ';
      UPDATE `services_citys` set region_id = '76000000000', country = 'Россия', region = 'Ярославская', city_longitude = '38.8425900', city_latitude = '58.0446000' where UPPER(name) = 'РЫБИНСК';
      UPDATE `services_citys` set region_id = '76000000000', country = 'Россия', region = 'Ярославская', city_longitude = '39.4139400', city_latitude = '57.1914000' where UPPER(name) = 'РОСТОВ';
      UPDATE `services_citys` set region_id = '44000000000', country = 'Россия', region = 'Костромская', city_longitude = '40.9268600', city_latitude = '57.7664700' where UPPER(name) = 'КОСТРОМА';
      UPDATE `services_citys` set region_id = '35000000000', country = 'Россия', region = 'Вологодская', city_longitude = '39.8839800', city_latitude = '59.2239000' where UPPER(name) = 'ВОЛОГДА';
      UPDATE `services_citys` set region_id = '37000000000', country = 'Россия', region = 'Ивановская',  city_longitude = '40.9713900', city_latitude = '56.9971900' where UPPER(name) = 'ИВАНОВО';
      UPDATE `services_citys` set region_id = '37000000000', country = 'Россия', region = 'Ивановская',  city_longitude = '40.5369200', city_latitude = '56.8579600' where UPPER(name) = 'ТЕЙКОВО';
      UPDATE `services_citys` set region_id = '52000000000', country = 'Россия', region = 'Нижегородская',  city_longitude = '44.0020500', city_latitude = '56.3286700' where UPPER(name) = 'НИЖНИЙ НОВГОРОД';
      UPDATE `services_citys` set region_id = '52000000000', country = 'Россия', region = 'Нижегородская',  city_longitude = '43.8399200', city_latitude = '55.3948500' where UPPER(name) = 'АРЗАМАС';
      UPDATE `services_citys` set region_id = '21000000000', country = 'Россия', region = 'Чувашская',  city_longitude = '47.2519400', city_latitude = '56.1322200' where UPPER(name) = 'ЧЕБОКСАРЫ';
      UPDATE `services_citys` set region_id = '21000000000', country = 'Россия', region = 'Чувашская',  city_longitude = '47.4775500', city_latitude = '56.1109500' where UPPER(name) = 'НОВОЧЕБОКСАРСК';
      UPDATE `services_citys` set region_id = '12000000000', country = 'Россия', region = 'Марий Эл',  city_longitude = '47.8907800', city_latitude = '56.6387700' where UPPER(name) = 'ЙОШКАР-ОЛА';
      UPDATE `services_citys` set region_id = '77000000000', country = 'Россия', region = 'Москва',  city_longitude = '37.6155600', city_latitude = '55.7522200' where UPPER(name) = 'МОСКВА';
    ]]></sql>
  </changeSet>
  <changeSet id="2015-10-26-02" author="dev1">
    <sql><![CDATA[
      UPDATE `services_citys` set city_longitude = '113.632114',  city_latitude = '51.928306'  where UPPER(name) = 'АТАМАНОВКА';
      UPDATE `services_citys` set city_longitude = '118.0369000', city_latitude = '50.0979000' where UPPER(name) = 'КРАСНОКАМЕНСК';
      UPDATE `services_citys` set city_longitude = '117.3255700', city_latitude = '49.6513000' where UPPER(name) = 'ЗАБАЙКАЛЬСК';
      UPDATE `services_citys` set city_longitude = '116.3144',    city_latitude = '50.5268'    where UPPER(name) = 'ШЕРЛОВАЯ ГОРА';
      UPDATE `services_citys` set city_longitude = '116.51667',   city_latitude = '50.38333'   where UPPER(name) = 'БОРЗЯ';
      UPDATE `services_citys` set city_longitude = '119.1012000', city_latitude = '50.3691000' where UPPER(name) = 'ПРИАРГУНСК';
    ]]></sql>
  </changeSet>
  <changeSet id="2015-10-26-03" author="dev1">
    <sql><![CDATA[
      CREATE TABLE `advertisements`
      (
        `id`   INT NOT NULL AUTO_INCREMENT,
        `text` VARCHAR(1024) NOT NULL DEFAULT '',
        `type` INT NOT NULL DEFAULT 0,
        PRIMARY KEY (`id`),
        UNIQUE INDEX `type_index` (`type` ASC)
      );
    ]]></sql>
  </changeSet>
  <changeSet id="2015-10-26-04" author="dev1">
    <sql><![CDATA[
	INSERT INTO `acl_rule` (`name`, `handle`) VALUES ('Редактирование объявлений', 'crm.advertisements');
    ]]></sql>
  </changeSet>
  <changeSet id="2015-10-27-01" author="dev1">
    <sql><![CDATA[
	ALTER TABLE vodils ADD COLUMN block_payments_in_park TINYINT NOT NULL DEFAULT 0;
    ]]></sql>
  </changeSet>
  <changeSet id="2015-10-29-01" author="dev1">
    <sql><![CDATA[
	INSERT INTO `acl_rule` (`name`, `handle`) VALUES ('Блокировать списание в парке', 'crm.block.payments.inpark');
    ]]></sql>
  </changeSet>
  <changeSet id="2015-11-06-01" author="dev1">
    <sql><![CDATA[
      INSERT INTO `params` (id, value, name) values ('109', '10', 'DRIVER_FAR');
      INSERT INTO `params` (id, value, name) values ('110', '0', 'DRIVER_SPY');
      INSERT INTO `params` (id, value, name) values ('111', '10', 'DRIVER_LAZY');
    ]]></sql>
  </changeSet>
  <changeSet id="2015-11-12-01" author="dev1">
    <sql><![CDATA[
    INSERT INTO `cfg_setting` (`handle`, `val`) VALUES ('crm.autoanswer', '0');
    ]]></sql>
  </changeSet>
  <changeSet id="2015-11-23-01" author="dev1">
    <sql><![CDATA[
      INSERT INTO `params` (id, value, name) values ('112', '1', 'CLIENT_REGULAR');
    ]]></sql>
  </changeSet>
  <changeSet id="2015-12-08-01" author="dev1">
    <sql><![CDATA[
      ALTER TABLE gps_location ADD COLUMN order_id INT NOT NULL DEFAULT 0,
                               ADD COLUMN order_state INT NOT NULL DEFAULT 0;
    ]]></sql>
  </changeSet>
  <changeSet id="2015-12-23-01" author="dev1">
    <sql><![CDATA[
      INSERT INTO `params` (id, value, name) values ('113', '0', 'TAXIMETER_DRIVER');
    ]]></sql>
  </changeSet>
  <changeSet id="2015-12-23-02" author="dev1">
    <sql><![CDATA[
      ALTER TABLE `gps_location` 
        ADD INDEX `order_id_index` (`order_id` ASC),
        ADD INDEX `order_state_index` (`order_state` ASC);
    ]]></sql>
  </changeSet>
  <changeSet id="2016-01-26-01" author="dev1">
    <sql><![CDATA[
      CREATE TABLE `distances`
      (
        `id`        INT NOT NULL AUTO_INCREMENT,
        `addr_from` INT NOT NULL DEFAULT 0,
        `addr_to`   INT NOT NULL DEFAULT 0,
        `distance`  DECIMAL(10,2) NOT NULL DEFAULT 0.0,
        `minutes`   DECIMAL(10,1) NOT NULL DEFAULT 0.0,   
        `price`     DECIMAL(10,2) NOT NULL DEFAULT 0.0,
        PRIMARY KEY (`id`),
        UNIQUE INDEX `addr_index` (`addr_from` ASC, `addr_to` ASC)
      );
    ]]></sql>
  </changeSet>
  <changeSet id="2016-01-28-01" author="dev1">
  <sql><![CDATA[
    INSERT INTO `params` (id, value, name) values ('114', '0', 'CALC_FROM_DISTANCE_DIC');
  ]]></sql>
  </changeSet>
  <changeSet id="2016-02-02-04" author="dev1">
  <sql><![CDATA[
    ALTER TABLE `work_channels` ADD COLUMN `city` VARCHAR(64) NOT NULL DEFAULT "";
  ]]></sql>
  </changeSet>
  <changeSet id="2016-02-02-05" author="dev1">
  <sql><![CDATA[
    ALTER TABLE `drivers_state` ADD COLUMN `city` INT NOT NULL DEFAULT 0;
  ]]></sql>
  </changeSet>
  <changeSet id="2016-02-12-01" author="rp">
  <sql><![CDATA[
    ALTER TABLE `vodils` ADD INDEX `login` (`login` ASC);
  ]]></sql>
  </changeSet>
  <changeSet id="2016-02-17-01" author="dev1">
  <sql><![CDATA[
    INSERT INTO `params` (`id`, `value`, `name`) VALUES ('115', '60', 'TIME_FOR_CANCEL_RESERVED');
    INSERT INTO `params` (`id`, `value`, `name`) VALUES ('116', '0', 'TIME_FOR_CANCEL_RESERVED_ENABLE');
  ]]></sql>
  </changeSet>
  <changeSet id="2016-02-26-01" author="dev1">
  <sql><![CDATA[
    ALTER TABLE `drivers_state` ADD COLUMN `start_work_for_tariff` INT NOT NULL DEFAULT 0;
  ]]></sql>
  </changeSet>
    <changeSet id="2016-03-14-01" author="dev1">
  <sql><![CDATA[
    ALTER TABLE `client_phone_bind_code` ADD COLUMN `make_call` INT NOT NULL DEFAULT 0;
  ]]></sql>
  </changeSet>
  <changeSet id="2016-03-22-01" author="dev1">
    <sql><![CDATA[
      INSERT INTO `cfg_setting` (`handle`, `val`) VALUES ('cti.operator.ready', '0');
    ]]></sql>
  </changeSet>
  <changeSet id="2014-03-28-01" author="dev1">
    <sql><![CDATA[
      INSERT INTO `acl_rule` (`name`, `handle`) VALUES ('Графики и статистика', 'crm.statistics');
    ]]></sql>
  </changeSet>
  <changeSet id="2014-03-28-02" author="dev1">
    <sql><![CDATA[
      CREATE TABLE IF NOT EXISTS `statistic_types`
      (
        `id` int(10) unsigned NOT NULL,
        `name` varchar(256) NOT NULL,
        PRIMARY KEY (`id`)
      );
    ]]></sql>
  </changeSet>
  <changeSet id="2016-04-01-01" author="dev1">
    <sql><![CDATA[
      CREATE TABLE IF NOT EXISTS `statistic_data`
      (
        `id` int(10) unsigned NOT NULL DEFAULT 0,
        `value` int(10) NOT NULL DEFAULT 0,
        `city` int(3) NOT NULL DEFAULT 0,
        `date` datetime NOT NULL,
        INDEX `id_idx` (`id` ASC)
      );
    ]]></sql>
  </changeSet>
  <changeSet id="2016-04-01-02" author="dev1">
    <sql><![CDATA[
      insert into `statistic_types` (id, name) values (0, "Телефония - Готовых операторов");
      insert into `statistic_types` (id, name) values (1, "Телефония - Неготовых операторов");
      insert into `statistic_types` (id, name) values (2, "Телефония - Всего операторов");
      insert into `statistic_types` (id, name) values (3, "Телефония - Активных разговоров");
      insert into `statistic_types` (id, name) values (4, "Телефония - Звонков в ожидании");
      insert into `statistic_types` (id, name) values (5, "Заказы - Ожидающие");
      insert into `statistic_types` (id, name) values (6, "Заказы - Подача машины");
      insert into `statistic_types` (id, name) values (7, "Заказы - Выполняющиеся");
      insert into `statistic_types` (id, name) values (8, "Заказы - Предварительные");
      insert into `statistic_types` (id, name) values (9, "Заказы - Отмененные за час");
      insert into `statistic_types` (id, name) values (10, "Заказы - Принятые за час");
      insert into `statistic_types` (id, name) values (11, "Заказы грузовые - Ожидающие");
      insert into `statistic_types` (id, name) values (12, "Заказы грузовые - Подача машины");
      insert into `statistic_types` (id, name) values (13, "Заказы грузовые - Выполняющиеся");
      insert into `statistic_types` (id, name) values (14, "Заказы грузовые - Предварительные");
      insert into `statistic_types` (id, name) values (15, "Заказы грузовые - Отмененные за час");
      insert into `statistic_types` (id, name) values (16, "Заказы грузовые - Звонков в ожидании");
    ]]></sql>
  </changeSet> 
  <changeSet id="2016-04-08-01" author="dev1">
  <sql><![CDATA[
    INSERT INTO `params` (`id`, `value`, `name`) VALUES ('117', '0', 'TIME_FOR_CLOSING_DRIVERS');
    INSERT INTO `params` (`id`, `value`, `name`) VALUES ('118', '0', 'TIME_FOR_CLOSING_DRIVERS_ENABLE');
  ]]></sql>
  </changeSet>
  <changeSet id="2016-12-19-01" author="dev1">
  <sql><![CDATA[
    ALTER TABLE taxi_prices MODIFY price DECIMAL(10,2);
  ]]></sql>
  </changeSet>
  <changeSet id="2016-12-22-01" author="dev1">
    <sql><![CDATA[
	  ALTER TABLE `zakazi` ADD COLUMN `pay_status`  INT UNSIGNED NOT NULL DEFAULT 0,
	                       ADD COLUMN `amount_paid` INT NOT NULL DEFAULT 0;
    ]]></sql>
  </changeSet>
  <changeSet id="2016-12-23-01" author="dev1">
  <sql><![CDATA[
      ALTER TABLE `zakazi_archive` ADD COLUMN `pay_status`  INT UNSIGNED NOT NULL DEFAULT 0,
	                               ADD COLUMN `amount_paid` INT NOT NULL DEFAULT 0;
  ]]></sql>
  </changeSet>
  <changeSet id="2016-12-26-01" author="dev1">
  <sql><![CDATA[
    ALTER TABLE zakazi MODIFY price DECIMAL(10,2);
	ALTER TABLE zakazi_archive MODIFY price DECIMAL(10,2);
	ALTER TABLE zakazi MODIFY precalculated_price DECIMAL(10,2);
	ALTER TABLE zakazi_archive MODIFY precalculated_price DECIMAL(10,2);
  ]]></sql>
  </changeSet>
    <changeSet id="2016-12-27-01" author="dev1">
  <sql><![CDATA[
    ALTER TABLE zakazi MODIFY sum_from_schet DECIMAL(10,2);
	ALTER TABLE zakazi_archive MODIFY sum_from_schet DECIMAL(10,2);
  ]]></sql>
  </changeSet>
  <changeSet id="2016-11-30-01" author="dev1">
    <sql><![CDATA[
      ALTER TABLE `zakazi_history` ADD COLUMN `notification_sent` TINYINT NOT NULL DEFAULT 1;
    ]]></sql>
  </changeSet>
  <changeSet id="2016-11-30-02" author="dev1">
    <sql><![CDATA[
      INSERT INTO `params` (id, value, name) values ('122', '', 'ONE_SIGNAL_AUTH');
	  INSERT INTO `params` (id, value, name) values ('123', '', 'ONE_SIGNAL_ID');
    ]]></sql>
  </changeSet>
  <changeSet id="2016-08-09-01" author="dev1">
    <sql><![CDATA[
      CREATE TABLE IF NOT EXISTS `bus4us_orders`
      (
        `id`          INT        UNSIGNED  NOT NULL AUTO_INCREMENT,
        `order_id`    INT        UNSIGNED  NOT NULL DEFAULT 0,
        `bus_type`    TINYINT(2) DEFAULT 0 NOT NULL,
        `time_finish` DATETIME   NOT NULL  DEFAULT '0000-00-00 00:00:00',
        `passengers`  INT(5)     DEFAULT 0 NOT NULL,
        `child_group` INT(5)     DEFAULT 0 NOT NULL,
        PRIMARY KEY (`id`),
        UNIQUE INDEX `order_id_idx` (`order_id` ASC)
      );
    ]]></sql>
  </changeSet>
  <changeSet id="2016-08-09-02" author="dev1">
    <sql><![CDATA[
      CREATE TABLE IF NOT EXISTS `bus4us_clients`
      (
        `id`           INT          UNSIGNED   NOT NULL AUTO_INCREMENT,
        `client_id`    INT          UNSIGNED   NOT NULL DEFAULT 0,
        `time_to_call` VARCHAR(256) DEFAULT '' NOT NULL,
        `number_board` VARCHAR(256) DEFAULT '' NOT NULL,
        PRIMARY KEY (`id`),
        UNIQUE INDEX `client_id_idx` (`client_id` ASC)
      );
    ]]></sql>
  </changeSet>
  <changeSet id="2016-08-09-03" author="dev1">
    <sql><![CDATA[
      CREATE TABLE IF NOT EXISTS `vehicle`
      (
        `id`               INT          UNSIGNED   NOT NULL AUTO_INCREMENT,
        `type`             INT          UNSIGNED   NOT NULL DEFAULT 0,
        `class`            INT          UNSIGNED   NOT NULL DEFAULT 0,
        `brand`            VARCHAR(256) DEFAULT '' NOT NULL,
        `model`            VARCHAR(256) DEFAULT '' NOT NULL,
        `plate`            VARCHAR(64)  DEFAULT '' NOT NULL,    
        `color`            VARCHAR(64)  DEFAULT '' NOT NULL,
        `capacity`         INT          UNSIGNED   NOT NULL DEFAULT 0,
        `car_service`      DATETIME     NOT NULL DEFAULT '0000-00-00 00:00:00',
        `next_car_service` DATETIME     NOT NULL DEFAULT '0000-00-00 00:00:00',
        `insurance`        DATETIME     NOT NULL DEFAULT '0000-00-00 00:00:00',
        `comment`          TEXT      ,
        PRIMARY KEY (`id`)
      );
    ]]></sql>
  </changeSet>
  <changeSet id="2016-08-09-04" author="dev1">
    <sql><![CDATA[
      CREATE TABLE IF NOT EXISTS `bus4us_drivers`
      (
        `id`                  INT          UNSIGNED   NOT NULL AUTO_INCREMENT,
        `driver_id`           INT          UNSIGNED   NOT NULL DEFAULT 0,
        `category`            VARCHAR(16)  NOT NULL   DEFAULT '',
        `experience`          TINYINT      UNSIGNED   NOT NULL DEFAULT 0,
        `citizenship`         VARCHAR(256) NOT NULL   DEFAULT '',
        `passport`            VARCHAR(512) NOT NULL   DEFAULT '',
        `moscow_registration` TINYINT(1)   UNSIGNED   NOT NULL   DEFAULT 0,
        `registration`        VARCHAR(512) NOT NULL   DEFAULT '',
        `photo`               VARCHAR(256) NOT NULL   DEFAULT '',
        `smoking`             TINYINT(1)   NOT NULL   DEFAULT 0,
        `sport_club`          VARCHAR(256) NOT NULL   DEFAULT '',
        PRIMARY KEY (`id`),
        UNIQUE INDEX `driver_id_idx` (`driver_id` ASC)
      );
    ]]></sql>
  </changeSet>
  <changeSet id="2016-08-09-05" author="dev1">
    <sql><![CDATA[
      CREATE TABLE IF NOT EXISTS `vehicle_type`
      (
        `id`   INT UNSIGNED NOT NULL DEFAULT 0,
        `type` VARCHAR(256) NOT NULL DEFAULT '',
        PRIMARY KEY (`id`)
      );
    ]]></sql>
  </changeSet>
  <changeSet id="2016-08-09-06" author="dev1">
    <sql><![CDATA[
      CREATE TABLE IF NOT EXISTS `vehicle_photos`
      (
        `id`         INT  UNSIGNED  NOT NULL AUTO_INCREMENT,
        `vehicle_id` INT  UNSIGNED  NOT NULL DEFAULT 0,
        `path`       VARCHAR(256) NOT NULL DEFAULT '',
        `name`       VARCHAR(256) NOT NULL DEFAULT '',
        PRIMARY KEY (`id`),
        INDEX `vehicle_id_idx` (`vehicle_id` ASC)
      );
    ]]></sql>
  </changeSet>
  <changeSet id="2016-08-09-07" author="dev1">
    <sql><![CDATA[
      CREATE TABLE IF NOT EXISTS `phone_numbers`
      (
        `id`         INT           UNSIGNED NOT NULL AUTO_INCREMENT,
        `number`     VARCHAR(256)  NOT NULL DEFAULT '',
        `name`       VARCHAR(256)  NOT NULL DEFAULT '',
        PRIMARY KEY (`id`)
      );
    ]]></sql>
  </changeSet>
  <changeSet id="2016-08-09-08" author="dev1">
    <sql><![CDATA[
      CREATE TABLE IF NOT EXISTS `phone_types`
      (
        `id`         INT      UNSIGNED  NOT NULL AUTO_INCREMENT,
        `phone_id`   INT      UNSIGNED  NOT NULL DEFAULT 0,
        `object_id`  INT      UNSIGNED  NOT NULL DEFAULT 0,
        `type`       TINYINT  UNSIGNED  NOT NULL DEFAULT 0,
        PRIMARY KEY (`id`),
        UNIQUE INDEX `phone_id_idx` (`phone_id` ASC),
        UNIQUE INDEX `object_type_idx` (`object_id`, `type` ASC)
      );
    ]]></sql>
  </changeSet>
  <changeSet id="2016-09-09-01" author="dev1">
    <sql><![CDATA[
        ALTER TABLE `bus4us_orders` ADD COLUMN manager VARCHAR(256) NOT NULL DEFAULT '';
    ]]></sql>
  </changeSet>
  <changeSet id="2016-09-09-02" author="dev1">
    <sql><![CDATA[
        ALTER TABLE `bus4us_orders`  DROP COLUMN id;
        ALTER TABLE `bus4us_clients` DROP COLUMN id;
        ALTER TABLE `bus4us_drivers` DROP COLUMN id;
        ALTER TABLE `vehicle_photos` DROP COLUMN id;
        ALTER TABLE `phone_types`    DROP COLUMN id;
    ]]></sql>
  </changeSet>
  <changeSet id="2016-09-19-01" author="dev1">
    <sql><![CDATA[
        CREATE TABLE IF NOT EXISTS `routes`
        (
		  `order_id`   INT           UNSIGNED  NOT NULL DEFAULT 0,
          `id`         INT           UNSIGNED  NOT NULL DEFAULT 0,
          `date_time`  DATETIME      NOT NULL  DEFAULT '0000-00-00 00:00:00',		  
          INDEX (`order_id`)
        );
    ]]></sql>
  </changeSet>
  <changeSet id="2016-09-20-01" author="dev1">
    <sql><![CDATA[
       ALTER TABLE `routes` ADD COLUMN `longitude` DECIMAL(12, 9) NOT NULL DEFAULT 0.00,
	                        ADD COLUMN `latitude`  DECIMAL(12, 9) NOT NULL DEFAULT 0.00,
							ADD COLUMN `route_sequence` INT UNSIGNED NOT NULL DEFAULT 0;
    ]]></sql>
  </changeSet>
  <changeSet id="2016-09-29-01" author="dev1">
    <sql><![CDATA[
      CREATE TABLE IF NOT EXISTS `bus4us_contacts`
      (
        `order_id`      INT          UNSIGNED DEFAULT 0 NOT NULL,
        `contact_name`  VARCHAR(256) DEFAULT '' NOT NULL,
        `contact_phone` VARCHAR(256) DEFAULT '' NOT NULL,
        PRIMARY KEY (`order_id`)
      );
    ]]></sql>
  </changeSet>
  <changeSet id="2016-10-06-01" author="dev1">
    <sql><![CDATA[
        ALTER TABLE `routes` ADD PRIMARY KEY (`order_id`, `route_sequence`);
		ALTER TABLE `bus4us_contacts` ADD COLUMN `contact_sequence` INT UNSIGNED NOT NULL DEFAULT 0;
		ALTER TABLE `bus4us_contacts` DROP PRIMARY KEY,
		                              ADD PRIMARY KEY (`order_id`, `contact_sequence`);
    ]]></sql>
  </changeSet>
  <changeSet id="2016-10-10-01" author="dev1">
  <sql><![CDATA[
    ALTER TABLE `drivers_state` ADD COLUMN `vehicle` INT NOT NULL DEFAULT 0;
  ]]></sql>
  </changeSet>
  <changeSet id="2016-11-10-01" author="dev1">
  <sql><![CDATA[
    ALTER TABLE `bus4us_orders` ADD COLUMN `user`  INT NOT NULL DEFAULT 0;
	ALTER TABLE `bus4us_orders` ADD COLUMN `email` VARCHAR(256) NOT NULL DEFAULT '';
  ]]></sql>
  </changeSet>
  <changeSet id="2016-11-22-01" author="dev1">
    <sql><![CDATA[
      INSERT INTO `params` (id, value, name) values ('120', 'http://klavto.clients.tlc.local/photos', 'KLAVTO_PHOTO_HTTP_PATH');
	  INSERT INTO `params` (id, value, name) values ('121', '\\\\klavto.clients.tlc.local\\photos', 'KLAVTO_PHOTO_SMB_PATH');
    ]]></sql>
  </changeSet>
  <changeSet id="2016-11-30-03" author="dev1">
    <sql><![CDATA[
      ALTER TABLE `gps_location` ADD COLUMN `altitude` INT NOT NULL DEFAULT 0;
    ]]></sql>
  </changeSet>
  <changeSet id="2016-12-05-01" author="dev1">
    <sql><![CDATA[
      ALTER TABLE `routes` ADD COLUMN `done`           INT NOT NULL DEFAULT 0;
      ALTER TABLE `routes` ADD COLUMN `date_time_done` DATETIME NOT NULL  DEFAULT '0000-00-00 00:00:00';
    ]]></sql>
  </changeSet>
  <changeSet id="2016-12-06-01" author="dev1">
    <sql><![CDATA[
      CREATE TABLE `drivers_vehicles`
      (
        `driver_id`  INT NOT NULL DEFAULT 0,
        `vehicle_id` INT NOT NULL DEFAULT 0,        
        INDEX `driver_idx`  (`driver_id` ASC),
		INDEX `vehicle_idx` (`vehicle_id` ASC)
      );
    ]]></sql>
  </changeSet>
  <changeSet id="2016-12-06-01" author="rp">
    <sql><![CDATA[
      ALTER TABLE `gps_location` ADD COLUMN `accuracy` INT NOT NULL DEFAULT 0;
    ]]></sql>
  </changeSet>
  <changeSet id="2016-12-07-01" author="dev1">
    <sql><![CDATA[
      ALTER TABLE `drivers_vehicles` ADD PRIMARY KEY (`driver_id`, `vehicle_id`);
    ]]></sql>
  </changeSet>   
  <changeSet id="2016-12-19-02" author="dev1">
    <sql><![CDATA[
      CREATE TABLE IF NOT EXISTS `geocoding`
      (
        `id`                  INT           UNSIGNED   NOT NULL AUTO_INCREMENT,
        `request`             VARCHAR(256)  NOT NULL   DEFAULT '',
        `answer`              VARCHAR(2048) NOT NULL   DEFAULT '',
        PRIMARY KEY (`id`),
        UNIQUE INDEX `request_idx` (`request` ASC)
      );
    ]]></sql>
  </changeSet>
  <changeSet id="2017-01-27-01" author="dev1">
    <sql><![CDATA[
      INSERT INTO `params` (id, value, name) values ('124', 'http://yandex.ru', 'NEWS_URL');
    ]]></sql>
  </changeSet>
  <changeSet id="2017-01-31-01" author="dev1">
    <sql><![CDATA[
      ALTER TABLE `bus4us_orders` ADD COLUMN `order_card_text` VARCHAR(256) NOT NULL DEFAULT '';
    ]]></sql>
  </changeSet>
  <changeSet id="2016-02-03-01" author="dev1">
    <sql><![CDATA[
	  ALTER TABLE `zakazi` MODIFY `amount_paid` DECIMAL(10,2) NOT NULL DEFAULT 0;
	  ALTER TABLE `zakazi_archive` MODIFY `amount_paid` DECIMAL(10,2) NOT NULL DEFAULT 0;
    ]]></sql>
  </changeSet>
  <changeSet id="2016-02-06-01" author="dev1">
    <sql><![CDATA[
      ALTER TABLE `zakazi` ADD COLUMN `late_reason` VARCHAR(256) NOT NULL DEFAULT '';
      ALTER TABLE `zakazi_archive` ADD COLUMN `late_reason` VARCHAR(256) NOT NULL DEFAULT '';
    ]]></sql>
  </changeSet>
  <changeSet id="2016-02-06-02" author="dev1">
    <sql><![CDATA[
      CREATE TABLE IF NOT EXISTS `alarms`
      (
        `id`               INT           UNSIGNED   NOT NULL AUTO_INCREMENT,
        `type`             VARCHAR(128)  NOT NULL   DEFAULT '',        
        PRIMARY KEY (`id`)        
      );
    ]]></sql>
  </changeSet>
  <changeSet id="2016-02-06-03" author="dev1">
    <sql><![CDATA[
  	  INSERT INTO `alarms` (type) VALUES ('ДТП');
	  INSERT INTO `alarms` (type) VALUES ('ГИБДД');
	  INSERT INTO `alarms` (type) VALUES ('Прокол');
	  INSERT INTO `alarms` (type) VALUES ('Неисправность');
    ]]></sql>
  </changeSet>
    <changeSet id="2016-02-06-04" author="dev1">
    <sql><![CDATA[
      ALTER TABLE `executor_alarm` ADD COLUMN `alarm_id` INT NOT NULL DEFAULT 0,
                                   ADD COLUMN `alarm_text` VARCHAR(256) NOT NULL DEFAULT '';
    ]]></sql>
  </changeSet>
  <changeSet id="2016-02-21-01" author="dev1">
  <sql><![CDATA[
    ALTER TABLE clients_billing MODIFY summa DECIMAL(10,2);
  ]]></sql>
  </changeSet>
  <changeSet id="2014-03-29-01" author="dev1">
    <sql><![CDATA[
      INSERT INTO `acl_rule` (`name`, `handle`) VALUES ('Удаление записей в биллинге', 'crm.billing.delete');
    ]]></sql>
  </changeSet>
  <changeSet id="2017-03-03-01" author="dev1">
    <sql><![CDATA[
      CREATE TABLE `trip_types`
      (
        `id`        INT          UNSIGNED   NOT NULL AUTO_INCREMENT,
        `trip_type` VARCHAR(256) DEFAULT '' NOT NULL,        
         PRIMARY KEY(`id`)
      )
	  ENGINE=InnoDB DEFAULT CHARSET=utf8;
    ]]></sql>
  </changeSet>
  <changeSet id="2017-03-03-02" author="dev1">
    <sql><![CDATA[
      CREATE TABLE `order_info_sources`
      (
        `id`        INT          UNSIGNED   NOT NULL AUTO_INCREMENT,
        `source`    VARCHAR(256) DEFAULT '' NOT NULL,        
         PRIMARY KEY(`id`)
      )
	  ENGINE=InnoDB DEFAULT CHARSET=utf8;
    ]]></sql>
  </changeSet>
  <changeSet id="2017-03-03-03" author="dev1">
    <sql><![CDATA[
      ALTER TABLE `bus4us_contacts` ADD COLUMN `age`   INT UNSIGNED NOT NULL DEFAULT 0,
                                    ADD COLUMN `email` VARCHAR(256) DEFAULT '';
    ]]></sql>
  </changeSet>
  <changeSet id="2017-03-03-04" author="dev1">
    <sql><![CDATA[
      ALTER TABLE `bus4us_orders`   ADD COLUMN `flight_number`     INT UNSIGNED NOT NULL DEFAULT 0,
                                    ADD COLUMN `flight_subnumber`  INT UNSIGNED NOT NULL DEFAULT 0,
			                        ADD COLUMN `external_order_id` INT UNSIGNED NOT NULL DEFAULT 0;
    ]]></sql>
  </changeSet>
  <changeSet id="2017-03-03-05" author="dev1">
    <sql><![CDATA[
      ALTER TABLE `bus4us_orders`   ADD COLUMN `trip_type`         INT UNSIGNED NOT NULL DEFAULT 0,
                                    ADD COLUMN `order_info_source` INT UNSIGNED NOT NULL DEFAULT 0,
			                        ADD COLUMN `deviations`        INT UNSIGNED NOT NULL DEFAULT 0;
    ]]></sql>
  </changeSet>     
  <changeSet id="2017-02-28-01" author="rp">
    <sql><![CDATA[
      CREATE TABLE IF NOT EXISTS `gps_location_archive` (
	  `id` int(10) NOT NULL AUTO_INCREMENT,
	  `driver_id` int(10) NOT NULL DEFAULT '0',
	  `time_r` datetime NOT NULL DEFAULT '0000-00-00 00:00:00',
	  `time` datetime NOT NULL DEFAULT '0000-00-00 00:00:00',
	  `lattitude` decimal(10,4) NOT NULL DEFAULT '0.0000',
	  `longitude` decimal(10,4) NOT NULL DEFAULT '0.0000',
	  `speed` int(10) NOT NULL DEFAULT '0',
	  `distance` int(10) NOT NULL DEFAULT '0',
	  `direction` int(10) NOT NULL DEFAULT '0',
	  `order_id` int(11) NOT NULL DEFAULT '0',
	  `order_state` int(11) NOT NULL DEFAULT '0',
	  PRIMARY KEY (`id`),
	  KEY `driver_id` (`driver_id`),
	  KEY `time_r` (`time_r`),
	  KEY `time` (`time`),
	  KEY `order_id_index` (`order_id`),
	  KEY `order_state_index` (`order_state`)
	) ENGINE=MyISAM DEFAULT CHARSET=utf8;
    ]]></sql>
  </changeSet>
  <changeSet id="2017-03-01-01" author="rp">
    <sql><![CDATA[
      ALTER TABLE `gps_location_archive` ADD COLUMN `accuracy` INT NOT NULL DEFAULT 0;
    ]]></sql>
  </changeSet>
  <changeSet id="2017-03-01-02" author="rp">
    <sql><![CDATA[
      ALTER TABLE `gps_location_archive` ADD COLUMN `altitude` INT NOT NULL DEFAULT 0;
    ]]></sql>
  </changeSet>
  <changeSet id="2017-03-05-01" author="rp">
    <sql><![CDATA[
        ALTER TABLE `zakazi_history` ADD INDEX `notificationIdx` (`notification_sent` ASC);
    ]]></sql>
  </changeSet>
  <changeSet id="2017-03-06-01" author="dev1">
    <sql><![CDATA[
      ALTER TABLE `bus4us_orders`   ADD COLUMN `flight_time`       INT UNSIGNED NOT NULL DEFAULT 0;
    ]]></sql>
  </changeSet>
  <changeSet id="2017-03-06-02" author="dev1">
    <sql><![CDATA[
      ALTER TABLE `bus4us_orders`   ADD COLUMN `flight_type`       INT UNSIGNED NOT NULL DEFAULT 0,
	                                MODIFY     `flight_number`     VARCHAR(256) ,
									MODIFY     `flight_subnumber`  VARCHAR(256),
									MODIFY     `external_order_id` VARCHAR(64);
    ]]></sql>
  </changeSet>
  <changeSet id="2017-03-06-03" author="dev1">
    <sql><![CDATA[
      ALTER TABLE `bus4us_contacts` CHANGE COLUMN `age`   `contact_age`  INT,
                                    CHANGE COLUMN `email` `contact_mail` VARCHAR(256);
    ]]></sql>
  </changeSet>
  <changeSet id="2017-03-07-01" author="dev1">
    <sql><![CDATA[
      INSERT INTO `trip_types` (`trip_type`) VALUES ('трансфер по городу');
	  INSERT INTO `trip_types` (`trip_type`) VALUES ('аренда');
	  INSERT INTO `trip_types` (`trip_type`) VALUES ('трансфер из аэропорта');
	  INSERT INTO `trip_types` (`trip_type`) VALUES ('межгород');
	  INSERT INTO `trip_types` (`trip_type`) VALUES ('смешанный тип');
    ]]></sql>
  </changeSet>
  <changeSet id="2017-03-09-01" author="dev1">
    <sql><![CDATA[
      ALTER TABLE `bus4us_orders`   ADD COLUMN `rent_time`   INT UNSIGNED NOT NULL DEFAULT 0;
    ]]></sql>
  </changeSet>  
  <changeSet id="2017-03-10-01" author="dev1">
    <sql><![CDATA[
      ALTER TABLE `routes` ADD COLUMN wait_time INT UNSIGNED NOT NULL DEFAULT 0;
    ]]></sql>
  </changeSet>
  <changeSet id="2017-03-15-01" author="dev1">
    <sql><![CDATA[
      CREATE TABLE IF NOT EXISTS `languages`
	  (
	    `id`   INT UNSIGNED NOT NULL AUTO_INCREMENT,
	    `name` VARCHAR(128) NOT NULL DEFAULT '',
	    `abbr` VARCHAR(16)  NOT NULL DEFAULT '',
	    PRIMARY KEY (`id`)	  
	  ) ENGINE=MyISAM DEFAULT CHARSET=utf8;   

      INSERT INTO languages (name, abbr) VALUES ('Русский', 'ru');
      INSERT INTO languages (name, abbr) VALUES ('Английский', 'en');
      INSERT INTO languages (name, abbr) VALUES ('Французский', 'fr');
      INSERT INTO languages (name, abbr) VALUES ('Немецкий', 'de');	 

      ALTER TABLE `bus4us_orders` ADD COLUMN `language` INT UNSIGNED NOT NULL DEFAULT 0;	  
    ]]></sql>
  </changeSet>
  <changeSet id="2017-03-15-02" author="dev1">
    <sql><![CDATA[
      ALTER TABLE `bus4us_orders` ADD COLUMN `incoming_letter` TEXT NOT NULL;
    ]]></sql>
  </changeSet>
  <changeSet id="2017-03-17-01" author="dev1">
    <sql><![CDATA[
      ALTER TABLE `vodils` ADD COLUMN `time` DATETIME NOT NULL DEFAULT '0000-00-00 00:00:00';
    ]]></sql>
  </changeSet>
  <changeSet id="2017-03-21-01" author="dev1">
    <sql><![CDATA[
      ALTER TABLE `drivers_vehicles` ADD COLUMN `default_vehicle` TINYINT(1) NOT NULL DEFAULT 0;
    ]]></sql>
  </changeSet>
  <changeSet id="2017-03-27-01" author="dev1">
    <sql><![CDATA[
      ALTER TABLE `object` ADD COLUMN `region`    VARCHAR(256) NOT NULL DEFAULT '',
	                       ADD COLUMN `city_real` VARCHAR(256) NOT NULL DEFAULT '';
    ]]></sql>
  </changeSet>
  <changeSet id="2017-03-31-01" author="dev1">
    <sql><![CDATA[
      ALTER TABLE `bus4us_drivers`  ADD COLUMN `document_photo` VARCHAR(256) NOT NULL DEFAULT '',
	                                ADD COLUMN `languages`      TEXT NOT NULL;
							
	  ALTER TABLE `vodils`          ADD COLUMN  `sms_info`      TINYINT(1) NOT NULL DEFAULT 0,
	                                ADD COLUMN  `mail_info`     TINYINT(1) NOT NULL DEFAULT 0;
									
	  ALTER TABLE `clients`          ADD COLUMN  `language`      TINYINT(1) NOT NULL DEFAULT 0;
    ]]></sql>
  </changeSet>
  <changeSet id="2017-04-01-01" author="rp">
    <sql><![CDATA[
      ALTER TABLE `object` ADD COLUMN `latitude` decimal(10,4) NOT NULL DEFAULT '0.0000',
	                       ADD COLUMN `longitude` decimal(10,4) NOT NULL DEFAULT '0.0000';
    ]]></sql>
  </changeSet>
<changeSet id="2017-04-01-01" author="dev1">
    <sql><![CDATA[									
	  ALTER TABLE `clients`         ADD COLUMN  `car_type`      INT NOT NULL DEFAULT 0;
	  ALTER TABLE `organizations`   ADD COLUMN  `acc_office`    VARCHAR(512) NOT NULL DEFAULT '',
	                                ADD COLUMN  `web_site`      VARCHAR(256) NOT NULL DEFAULT '';
									
      CREATE TABLE IF NOT EXISTS `org_order_info`
	  (
	    `organization_id`   INT UNSIGNED NOT NULL DEFAULT 0,
	    `company_type`      INT UNSIGNED NOT NULL DEFAULT 0,
	    `cooperation_type`  INT UNSIGNED NOT NULL DEFAULT 0,
		`addr_id`           INT UNSIGNED NOT NULL DEFAULT 0,
		`disp_message`      TEXT NOT NULL,
		`clearing`          TINYINT(1) UNSIGNED NOT NULL DEFAULT 0,
		`deviations`        INT UNSIGNED NOT NULL DEFAULT 0,
		`car_class`         INT UNSIGNED NOT NULL DEFAULT 0,
		`discount`          DECIMAL(10,2) NOT NULL DEFAULT 0.00,
		`discount_type`     TINYINT(1) UNSIGNED NOT NULL DEFAULT 0,
	    PRIMARY KEY (`organization_id`)	  
	  ) ENGINE=MyISAM DEFAULT CHARSET=utf8; 

      CREATE TABLE IF NOT EXISTS `company_type`
	  (
	    `id`       INT UNSIGNED NOT NULL AUTO_INCREMENT,
		`type`     VARCHAR(256) NOT NULL DEFAULT '',
	    PRIMARY KEY (`id`)	  
	  ) ENGINE=MyISAM DEFAULT CHARSET=utf8; 

      INSERT INTO `company_type` (type) VALUES ('Транспортная компания');
	  INSERT INTO `company_type` (type) VALUES ('Эвент агентсво');
	  INSERT INTO `company_type` (type) VALUES ('Организация (заводы, предприятия и пр.)');
	  INSERT INTO `company_type` (type) VALUES ('Тур агентство');
	  INSERT INTO `company_type` (type) VALUES ('Гостиницы');  
	  
	  CREATE TABLE IF NOT EXISTS `client_project_type`
	  (
	    `client`   INT UNSIGNED NOT NULL DEFAULT 0,
		`type`     VARCHAR(256) NOT NULL DEFAULT '',
	    INDEX `cliient_idx`  (`client` ASC)
	  ) ENGINE=MyISAM DEFAULT CHARSET=utf8; 
	  
	  ALTER TABLE `bus4us_drivers`  DROP COLUMN `languages`;
	  
	  CREATE TABLE IF NOT EXISTS `executor_languages`
	  (
	    `executor_id`   INT UNSIGNED NOT NULL DEFAULT 0,
		`language_id`   INT UNSIGNED NOT NULL DEFAULT 0,
	    INDEX `executor_idx`  (`executor_id` ASC)
	  ) ENGINE=MyISAM DEFAULT CHARSET=utf8; 
	 
    ]]></sql>
  </changeSet>
  <changeSet id="2017-04-10-01" author="dev1">
    <sql><![CDATA[
	  ALTER TABLE `vodils` ADD COLUMN `bank_info_type` TINYINT(1) NOT NULL DEFAULT 0,
                           ADD COLUMN `bank_info_name` VARCHAR(256) NOT NULL DEFAULT '',
                           ADD COLUMN `bank_info_inn`  VARCHAR(256) NOT NULL DEFAULT '',
                           ADD COLUMN `bank_info_bik`  VARCHAR(256) NOT NULL DEFAULT '',
                           ADD COLUMN `bank_info_bank_name` VARCHAR(256) NOT NULL DEFAULT '',
                           ADD COLUMN `bank_info_corr_acc`  VARCHAR(256) NOT NULL DEFAULT '',
                           ADD COLUMN `bank_info_curr_acc`  VARCHAR(256) NOT NULL DEFAULT '',
                           ADD COLUMN `bank_info_card_number` VARCHAR(256) NOT NULL DEFAULT '';
    ]]></sql>
  </changeSet>
  <changeSet id="2017-04-10-02" author="dev1">
    <sql><![CDATA[
	  ALTER TABLE `bank_details` ADD COLUMN agreement VARCHAR(512) NOT NULL DEFAULT '';
    ]]></sql>
  </changeSet>
  <changeSet id="2017-04-11-01" author="dev1">
    <sql><![CDATA[
	  DROP TABLE `client_project_type`;
    ]]></sql>
  </changeSet>
  <changeSet id="2017-04-11-02" author="dev1">
    <sql><![CDATA[
	  CREATE TABLE IF NOT EXISTS `org_projects`
	  (
	    `org_id`           INT UNSIGNED NOT NULL DEFAULT 0,
		`project_name`     VARCHAR(256) NOT NULL DEFAULT '',
	    INDEX `org_idx`  (`org_id` ASC)
	  ) ENGINE=MyISAM DEFAULT CHARSET=utf8; 
    ]]></sql>
  </changeSet>
  <changeSet id="2017-04-13-01" author="dev1">
    <sql><![CDATA[
	  CREATE TABLE IF NOT EXISTS `org_managers`
	  (
	    `org_id`        INT UNSIGNED NOT NULL DEFAULT 0,
		`client_id`     INT UNSIGNED NOT NULL DEFAULT 0,
		`type`          TINYINT(1)   NOT NULL DEFAULT 0,
	    INDEX `org_idx`    (`org_id` ASC),
		INDEX `client_idx` (`client_id` ASC)
	  ) ENGINE=MyISAM DEFAULT CHARSET=utf8; 
    ]]></sql>
  </changeSet>
  <changeSet id="2017-04-13-02" author="dev1">
    <sql><![CDATA[
      INSERT INTO `params` (id, value, name) values ('125', '1', 'BTONE_SIGN');
    ]]></sql>
  </changeSet>
  <changeSet id="2017-04-13-03" author="dev1">
    <sql><![CDATA[
      ALTER TABLE `clients` ADD COLUMN `org_id` INT UNSIGNED NOT NULL DEFAULT 0;
    ]]></sql>
  </changeSet>
  <changeSet id="2017-04-14-01" author="dev1">
    <sql><![CDATA[
      ALTER TABLE `zakazi` ADD COLUMN `manager_id` INT UNSIGNED NOT NULL DEFAULT 0,
	                       ADD COLUMN `project_id` INT UNSIGNED NOT NULL DEFAULT 0;
    ]]></sql>
  </changeSet>
  <changeSet id="2017-04-14-02" author="dev1">
    <sql><![CDATA[
      ALTER TABLE `org_projects` ADD COLUMN `project_id`  INT UNSIGNED NOT NULL DEFAULT 0,
                                 ADD INDEX  `project_idx` (`project_id` ASC);
    ]]></sql>
  </changeSet>  
  <changeSet id="2017-04-14-05" author="dev1">
    <sql><![CDATA[
      ALTER TABLE `vodils` ADD COLUMN `sms_notification_type` TINYINT NOT NULL DEFAULT 0;
    ]]></sql>
  </changeSet>
  <changeSet id="2017-04-14-06" author="dev1">
    <sql><![CDATA[
      INSERT INTO `params` (id, value, name) values ('126', 'http://bt-1.ru/c/[id водителя]/[id заказа]/', 'BTONE_DRIVER_CONFIRMATION_URL');
    ]]></sql>
  </changeSet>
  <changeSet id="2017-04-15-01" author="dev1">
    <sql><![CDATA[
      DELETE FROM `params` WHERE id = 126;
    ]]></sql>
  </changeSet>
  <changeSet id="2017-04-15-02" author="dev1">
    <sql><![CDATA[
      INSERT INTO `params` (id, value, name) values ('126', 'http://bt-1.ru/c/', 'BTONE_DRIVER_CONFIRMATION_URL');
    ]]></sql>
  </changeSet>
  <changeSet id="2017-04-15-04" author="dev1">
    <sql><![CDATA[
      INSERT INTO `params` (id, value, name) values ('127', '', 'BTONE_DRIVER_EMAIL_SERVER');
    ]]></sql>
  </changeSet>
  <changeSet id="2017-04-19-01" author="dev1">
    <sql><![CDATA[
    ALTER TABLE `routes` MODIFY wait_time INT NOT NULL DEFAULT 0;
    ]]></sql>
  </changeSet>
  <changeSet id="2017-04-19-02" author="dev1">
    <sql><![CDATA[
    ALTER TABLE `clients` ADD COLUMN order_period_from DATETIME NOT NULL DEFAULT '0000-00-00 00:00:00',
	                      ADD COLUMN order_period_to   DATETIME NOT NULL DEFAULT '0000-00-00 00:00:00';
    ]]></sql>
  </changeSet>
  <changeSet id="2017-04-20-01" author="rp">
    <sql><![CDATA[
      ALTER TABLE `zakazi_archive` ADD COLUMN `manager_id` INT UNSIGNED NOT NULL DEFAULT 0,
	                               ADD COLUMN `project_id` INT UNSIGNED NOT NULL DEFAULT 0;
    ]]></sql>
  </changeSet>
  <changeSet id="2017-04-20-02" author="dev1">
    <sql><![CDATA[
      ALTER TABLE `org_managers` ADD PRIMARY KEY (org_id, client_id);
    ]]></sql>
  </changeSet>
  <changeSet id="2017-04-20-03" author="dev1">
    <sql><![CDATA[
      ALTER TABLE `zakazi` ADD COLUMN org_id INT UNSIGNED NOT NULL DEFAULT 0;
    ]]></sql>
  </changeSet>
  <changeSet id="2017-04-20-04" author="dev1">
    <sql><![CDATA[
      ALTER TABLE `zakazi_archive` ADD COLUMN `org_id`     INT UNSIGNED NOT NULL DEFAULT 0;
    ]]></sql>
  </changeSet>
  <changeSet id="2017-04-24-01" author="dev1">
    <sql><![CDATA[
      REPLACE INTO `params` (id, value, name) values ('125', '0', 'BTONE_SIGN');
    ]]></sql>
  </changeSet>
  <changeSet id="2017-05-03-01" author="dev1">
    <sql><![CDATA[
      ALTER TABLE `bus4us_orders` ADD COLUMN `series` VARCHAR(256) NOT NULL DEFAULT '';
    ]]></sql>
  </changeSet>
  <changeSet id="2017-05-03-02" author="dev1">
    <sql><![CDATA[
      CREATE TABLE IF NOT EXISTS `orders_series_number`
	  (
	    `id` INT UNSIGNED NOT NULL DEFAULT 0,
		PRIMARY KEY (`id`)
	  ) ENGINE=InnoDB DEFAULT CHARSET=utf8;
    ]]></sql>
  </changeSet>
  <changeSet id="2017-05-03-03" author="dev1">
    <sql><![CDATA[
      INSERT INTO `orders_series_number` (id) values (1);
    ]]></sql>
  </changeSet>
  <changeSet id="2017-05-05-01" author="dev1">
    <sql><![CDATA[
      ALTER TABLE `zakazi` ADD COLUMN `cancellation_time` INT UNSIGNED NOT NULL DEFAULT 0;
    ]]></sql>
  </changeSet>
  <changeSet id="2017-05-05-02" author="dev1">
    <sql><![CDATA[
      ALTER TABLE `zakazi_archive` ADD COLUMN `cancellation_time` INT UNSIGNED NOT NULL DEFAULT 0;
    ]]></sql>
  </changeSet>
  <changeSet id="2017-05-05-03" author="dev1">
    <sql><![CDATA[
      INSERT INTO `params` (id, value, name) values ('128', '2', 'CANCELLATION_TIME');
    ]]></sql>
  </changeSet>
  <changeSet id="2017-05-05-04" author="dev1">
    <sql><![CDATA[
      ALTER TABLE `organizations` ADD COLUMN send_order_info       INT UNSIGNED NOT NULL DEFAULT 0,
                                  ADD COLUMN send_driver_info      INT UNSIGNED NOT NULL DEFAULT 0,
                                  ADD COLUMN send_closing_info     INT UNSIGNED NOT NULL DEFAULT 0,
                                  ADD COLUMN send_driver_info_time INT UNSIGNED NOT NULL DEFAULT 0,
                                  ADD COLUMN driver_info_time      INT UNSIGNED NOT NULL DEFAULT 0;
    ]]></sql>
  </changeSet>
  <changeSet id="2017-05-11-01" author="dev1">
    <sql><![CDATA[
      ALTER TABLE `clients` ADD COLUMN `problem` TINYINT NOT NULL DEFAULT 0;
    ]]></sql>
  </changeSet>
  <changeSet id="2017-05-15-01" author="dev1">
    <sql><![CDATA[
	  CREATE TABLE IF NOT EXISTS `orders_reviews`
	  (
	    `id`            INT UNSIGNED  NOT NULL AUTO_INCREMENT,
		`order_id`      INT UNSIGNED  NOT NULL DEFAULT 0,
		`time`          DATETIME      NOT NULL DEFAULT '0000-00-00 00:00:00',
		`type`          TINYINT(1)    NOT NULL DEFAULT 0,
		`user_type`     TINYINT(1)    NOT NULL DEFAULT 0,
		`user_id`       INT UNSIGNED  NOT NULL DEFAULT 0,
		`rating`        TINYINT(1)    NOT NULL DEFAULT 0,
		`comment`       VARCHAR(1024) NOT NULL DEFAULT '',
		PRIMARY KEY (`id`),
	    INDEX `order_idx`    (`order_id` ASC)		
	  ) ENGINE=MyISAM DEFAULT CHARSET=utf8; 
    ]]></sql>
  </changeSet>
  <changeSet id="2017-05-15-02" author="dev1">
    <sql><![CDATA[
	  CREATE TABLE IF NOT EXISTS `reviews_params`
	  (
	    `id`    INT UNSIGNED NOT NULL DEFAULT 0,
        `param` VARCHAR(256) NOT NULL DEFAULT '',
		`value` VARCHAR(256) NOT NULL DEFAULT '',
	    INDEX `id_idx` (`id` ASC)		
	  ) ENGINE=MyISAM DEFAULT CHARSET=utf8; 
    ]]></sql>
  </changeSet>
  <changeSet id="2017-05-18-01" author="dev1">
    <sql><![CDATA[
      ALTER TABLE `zakazi` ADD COLUMN btone_letter_org_send          TINYINT UNSIGNED NOT NULL DEFAULT 0,
	                       ADD COLUMN btone_letter_driver_send       TINYINT UNSIGNED NOT NULL DEFAULT 0,
                           ADD COLUMN btone_sms_passenger_day_send   TINYINT UNSIGNED NOT NULL DEFAULT 0,
						   ADD COLUMN btone_sms_passengers_hour_send TINYINT UNSIGNED NOT NULL DEFAULT 0;
    ]]></sql>
  </changeSet>
  <changeSet id="2017-05-18-02" author="dev1">
    <sql><![CDATA[
      ALTER TABLE `zakazi_online` ADD COLUMN btone_letter_org_send          TINYINT UNSIGNED NOT NULL DEFAULT 0,
	                              ADD COLUMN btone_letter_driver_send       TINYINT UNSIGNED NOT NULL DEFAULT 0,
                                  ADD COLUMN btone_sms_passenger_day_send   TINYINT UNSIGNED NOT NULL DEFAULT 0,
						          ADD COLUMN btone_sms_passengers_hour_send TINYINT UNSIGNED NOT NULL DEFAULT 0;
    ]]></sql>
  </changeSet>
  <changeSet id="2017-05-23-01" author="dev1">
    <sql><![CDATA[
      ALTER TABLE `zakazi` ADD COLUMN btone_cancel_sending TINYINT UNSIGNED NOT NULL DEFAULT 0;
    ]]></sql>
  </changeSet>
  <changeSet id="2017-05-23-02" author="dev1">
    <sql><![CDATA[
      ALTER TABLE `zakazi_online` ADD COLUMN btone_cancel_sending TINYINT UNSIGNED NOT NULL DEFAULT 0;
    ]]></sql>
  </changeSet>
  <changeSet id="2017-05-23-03" author="rp">
    <sql><![CDATA[
      ALTER TABLE `zakazi_archive` ADD COLUMN btone_letter_org_send          TINYINT UNSIGNED NOT NULL DEFAULT 0,
	                              ADD COLUMN btone_letter_driver_send       TINYINT UNSIGNED NOT NULL DEFAULT 0,
                                  ADD COLUMN btone_sms_passenger_day_send   TINYINT UNSIGNED NOT NULL DEFAULT 0,
						          ADD COLUMN btone_sms_passengers_hour_send TINYINT UNSIGNED NOT NULL DEFAULT 0;
    ]]></sql>
  </changeSet>
  <changeSet id="2017-05-23-04" author="dev1">
    <sql><![CDATA[
      ALTER TABLE `zakazi_archive` ADD COLUMN btone_cancel_sending TINYINT UNSIGNED NOT NULL DEFAULT 0;
    ]]></sql>
  </changeSet>
  <changeSet id="2017-05-24-01" author="dev1">
    <sql><![CDATA[
      ALTER TABLE `zakazi` ADD COLUMN btone_review_sending TINYINT UNSIGNED NOT NULL DEFAULT 0;
    ]]></sql>
  </changeSet>
  <changeSet id="2017-05-24-02" author="dev1">
    <sql><![CDATA[
      ALTER TABLE `zakazi_online` ADD COLUMN btone_review_sending TINYINT UNSIGNED NOT NULL DEFAULT 0;
    ]]></sql>
  </changeSet>
  <changeSet id="2017-05-24-03" author="dev1">
    <sql><![CDATA[
      ALTER TABLE `zakazi` DROP COLUMN btone_cancel_sending;
    ]]></sql>
  </changeSet>
  <changeSet id="2017-05-24-04" author="dev1">
    <sql><![CDATA[
      ALTER TABLE `zakazi_online` DROP COLUMN btone_cancel_sending;
    ]]></sql>
  </changeSet>
  <changeSet id="2017-05-26-01" author="dev1">
    <sql><![CDATA[
      INSERT INTO `params` (id, value, name) values ('129', '20', 'BTONE_DRIVER_INFO_SENDING_TIME');
    ]]></sql>
  </changeSet>
  <changeSet id="2017-05-29-01" author="dev1">
    <sql><![CDATA[
      ALTER TABLE `bus4us_orders` ADD COLUMN no_plate TINYINT(1) UNSIGNED NOT NULL DEFAULT 0;
    ]]></sql>
  </changeSet>
  <changeSet id="2017-05-30-01" author="rp">
    <sql><![CDATA[
      ALTER TABLE `zakazi_archive` ADD COLUMN btone_review_sending TINYINT UNSIGNED NOT NULL DEFAULT 0;
    ]]></sql>
  </changeSet>
  <changeSet id="2017-06-08-01" author="dev1">
    <sql><![CDATA[
      ALTER TABLE `org_order_info` ADD COLUMN show_in_letter INT UNSIGNED NOT NULL DEFAULT 0;                                  
    ]]></sql>
  </changeSet>
  <changeSet id="2017-06-08-02" author="dev1">
    <sql><![CDATA[
      ALTER TABLE `zakazi` ADD COLUMN show_in_letter INT UNSIGNED NOT NULL DEFAULT 0;                                  
    ]]></sql>
  </changeSet>
  <changeSet id="2017-06-08-03" author="dev1">
    <sql><![CDATA[
      ALTER TABLE `zakazi_archive` ADD COLUMN show_in_letter INT UNSIGNED NOT NULL DEFAULT 0;                                  
    ]]></sql>
  </changeSet>
  <changeSet id="2017-06-09-04" author="dev1">
    <sql><![CDATA[
      INSERT INTO `params` (id, value, name) values ('130', '5', 'BTONE_SUBMISSION');
    ]]></sql>
  </changeSet>
  <changeSet id="2017-06-15-01" author="rp">
    <sql><![CDATA[
      INSERT INTO `params` (id, value, name) values ('131', '0', 'AUTO_TTS_CAR_INTERVAL_BEFORE');
    ]]></sql>
  </changeSet>
  <changeSet id="2017-06-15-02" author="rp">
    <sql><![CDATA[
      CREATE TABLE `drivers_auth_token` (
        `driver_id` int(11) NOT NULL,
        `token` varchar(32) NOT NULL,
        `created` datetime NOT NULL,
        `updated` datetime NOT NULL,
        `expire` datetime NOT NULL,
        UNIQUE KEY `drivers_auth_token_ui1` (`token`)
      ) ENGINE=MyISAM DEFAULT CHARSET=utf8;
    ]]></sql>
  </changeSet>
  <changeSet id="2017-06-15-02" author="rp">
    <sql><![CDATA[
      CREATE TABLE `short_links` (
        `id` INT NOT NULL AUTO_INCREMENT,
        `link` VARCHAR(16) NOT NULL,
        `data` TEXT NOT NULL,
        PRIMARY KEY (`id`),
        INDEX `link` (`link` ASC))
      ENGINE = MyISAM;
    ]]></sql>
  </changeSet>
  <changeSet id="2017-06-25-01" author="rp">
    <sql><![CDATA[
      INSERT INTO `params` (id, value, name) values ('132', '', 'WEB_PLATFORM_URI');
    ]]></sql>
  </changeSet>
  <changeSet id="2017-06-28-01" author="dev1">
    <sql><![CDATA[
      ALTER TABLE `vehicle` ADD COLUMN imei VARCHAR(32) NOT NULL DEFAULT '';
    ]]></sql>
  </changeSet>
</databaseChangeLog>